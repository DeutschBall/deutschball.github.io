<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Cascadia Code:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"deutschball.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"万一找到了呢","hits_empty":"你说的 ${query} 我怎么找不着呢 ","hits_stats":"找到了 ${hits} 个结果，用时 ${time} 毫秒"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="关系代数与SQL语句 关系模型术语    关系模型术语 对应到表     关系 表   元组 行   属性 列   关系实例 表中的特定行   属性的域 该属性列中所有可能的取值    关系模式:定义类型 关系:关系模式的实例 Employer(ID,salary,gender,age);这就是关系模式 Tom(00001,5k">
<meta property="og:type" content="article">
<meta property="og:title" content="关系代数和SQL语言">
<meta property="og:url" content="http://deutschball.github.io/2022/09/16/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0%E5%92%8CSQL%E8%AF%AD%E8%A8%80/index.html">
<meta property="og:site_name" content="dustland">
<meta property="og:description" content="关系代数与SQL语句 关系模型术语    关系模型术语 对应到表     关系 表   元组 行   属性 列   关系实例 表中的特定行   属性的域 该属性列中所有可能的取值    关系模式:定义类型 关系:关系模式的实例 Employer(ID,salary,gender,age);这就是关系模式 Tom(00001,5k">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-09-15T16:59:00.000Z">
<meta property="article:modified_time" content="2022-11-14T01:42:56.216Z">
<meta property="article:author" content="dustball">
<meta property="article:tag" content="数据库">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://deutschball.github.io/2022/09/16/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0%E5%92%8CSQL%E8%AF%AD%E8%A8%80/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>关系代数和SQL语言 | dustland</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">dustland</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">dustball in dustland</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="algolia-results">
  <div id="algolia-stats"></div>
  <div id="algolia-hits"></div>
  <div id="algolia-pagination" class="algolia-pagination"></div>
</div>

      
    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/deutschball" class="github-corner" title="Follow me on GayHub" aria-label="Follow me on GayHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://deutschball.github.io/2022/09/16/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0%E5%92%8CSQL%E8%AF%AD%E8%A8%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/DeutschBall/picbed/main/dustball.png">
      <meta itemprop="name" content="dustball">
      <meta itemprop="description" content="dustland">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dustland">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          关系代数和SQL语言
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-09-16 00:59:00" itemprop="dateCreated datePublished" datetime="2022-09-16T00:59:00+08:00">2022-09-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-11-14 09:42:56" itemprop="dateModified" datetime="2022-11-14T09:42:56+08:00">2022-11-14</time>
              </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="关系代数与sql语句">关系代数与SQL语句</h1>
<h2 id="关系模型术语">关系模型术语</h2>
<table>
<thead>
<tr>
<th>关系模型术语</th>
<th>对应到表</th>
</tr>
</thead>
<tbody>
<tr>
<td>关系</td>
<td>表</td>
</tr>
<tr>
<td>元组</td>
<td>行</td>
</tr>
<tr>
<td>属性</td>
<td>列</td>
</tr>
<tr>
<td>关系实例</td>
<td>表中的特定行</td>
</tr>
<tr>
<td>属性的域</td>
<td>该属性列中所有可能的取值</td>
</tr>
</tbody>
</table>
<p>关系模式:定义类型</p>
<p>关系:关系模式的实例</p>
<p><code>Employer(ID,salary,gender,age);</code>这就是关系模式</p>
<p><code>Tom(00001,5k,male,20);</code>这就是关系</p>
<p>相当于</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employer</span>&#123;</span><span class="comment">//Employer关系模式</span></span><br><span class="line">	<span class="type">int</span> ID;</span><br><span class="line">    <span class="type">int</span> salary;</span><br><span class="line">    <span class="type">bool</span> gender;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    Employer(<span class="type">const</span> <span class="type">int</span> &amp;i,<span class="type">const</span> <span class="type">int</span> &amp;s,<span class="type">const</span> <span class="type">bool</span> &amp;g,<span class="type">const</span> <span class="type">int</span> &amp;a)&#123;</span><br><span class="line">    	ID=i;</span><br><span class="line">    	salary=s;</span><br><span class="line">    	gender=g;</span><br><span class="line">    	age=a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">Employer <span class="title function_">Tom</span><span class="params">(<span class="number">1</span>,<span class="number">5000</span>,<span class="number">1</span>,<span class="number">20</span>)</span>;<span class="comment">//关系,关系实例</span></span><br></pre></td></tr></table></figure>
<p>码:区分不同关系的标志</p>
<blockquote>
<p>比如人的身份证ID</p>
</blockquote>
<p>超码:关系模式中,能够唯一标识一个关系的属性或者属性集合</p>
<blockquote>
<p>比如Student(ID,eduID,class,grade,name)</p>
<p>学生(身份证号,学号,年级,班级,姓名)</p>
<p>这里ID和eduID都可以作为超码,</p>
<p>如果认为每个班里都没有重名的人,则(年级,班级,姓名)也可以作为超码</p>
</blockquote>
<blockquote>
<p>显然超码的任何一个超集也是超码</p>
</blockquote>
<p>候选码:最小超码</p>
<blockquote>
<p>比如Student(ID,eduID,class,grade,name)</p>
<p>由于ID是超码,因此ID的任何一个超集,比如(ID,grade)也是超码</p>
<p>ID可以作为候选码,因为ID已经是最小超码,但是(ID,grade)不是候选码,因为去了grade,只剩下ID仍然是超码</p>
</blockquote>
<p>主码(primary key):实际中,数据库设计者选中作为区分不同关系的候选码</p>
<blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> troop(</span><br><span class="line"> <span class="operator">-</span><span class="operator">&gt;</span> id <span class="type">int</span>,</span><br><span class="line"> <span class="operator">-</span><span class="operator">&gt;</span> name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line"> <span class="operator">-</span><span class="operator">&gt;</span> age <span class="type">int</span>,</span><br><span class="line"> <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">PRIMARY</span> KEY(id)</span><br><span class="line"> <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>
<p>将id作为主码</p>
</blockquote>
<p>外码:</p>
<p>关系模式r1的属性中可能包含其他关系模式r2的主码.</p>
<p>则该属性在r1上称作"参照r2的外码",</p>
<p>关系模式r1称为"外码依赖的参照关系"</p>
<p>关系模式r2称为"外码的被参照关系"</p>
<blockquote>
<p>比如</p>
<p>Person=Person(ID,eduID,name,age,gender),其中身份证号ID为主键</p>
<p>Student=Student(eduID,grade,class,name,age,gender),其中学号eduID为主键</p>
<p>那么eduID就是Person的"参照Student的外码"</p>
<p>Person就是"eduID外码依赖的参照关系"</p>
<p>Student就是"eduID外码的被参照关系"</p>
</blockquote>
<p>模式图:</p>
<p>用模式图(schema diagram)表示含有主码和外码依赖的数据库模式</p>
<p>这个玩意用软件画不用手画</p>
<h2 id="关系代数">关系代数</h2>
<figure>
<img
src="https://raw.githubusercontent.com/DeutschBall/DeutschBall/main/image-20220914113622895.png"
alt="image-20220914113622895" />
<figcaption aria-hidden="true">image-20220914113622895</figcaption>
</figure>
<table>
<colgroup>
<col style="width: 27%" />
<col style="width: 18%" />
<col style="width: 13%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr>
<th>Operation</th>
<th>中文</th>
<th>符号</th>
<th><span class="math inline">\(\LaTeX\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>Projection</td>
<td>投影</td>
<td>Π</td>
<td><code>\Pi</code></td>
</tr>
<tr>
<td>Selection</td>
<td>选择</td>
<td>σ</td>
<td><code>\sigma</code></td>
</tr>
<tr>
<td>Renaming</td>
<td>重命名</td>
<td>ρ</td>
<td><code>\rho</code></td>
</tr>
<tr>
<td>Aggregate Function</td>
<td>聚合函数</td>
<td>G</td>
<td><code>\mathcal&#123;G&#125;</code></td>
</tr>
<tr>
<td>Union</td>
<td>交</td>
<td>∩</td>
<td><code>\cap</code></td>
</tr>
<tr>
<td>Intersection</td>
<td>补</td>
<td>∪</td>
<td><code>\cup</code></td>
</tr>
<tr>
<td>Natural Join</td>
<td>自然连接</td>
<td>⋈</td>
<td><code>\bowtie</code> or <code>\Join</code></td>
</tr>
<tr>
<td>Left Outer Join</td>
<td>左外连接</td>
<td>⟕</td>
<td>... 这几个直接复制吧</td>
</tr>
<tr>
<td>Right Outer Join</td>
<td>右外连接</td>
<td>⟖</td>
<td></td>
</tr>
<tr>
<td>Full Outer Join</td>
<td>全外连接</td>
<td>⟗</td>
<td></td>
</tr>
<tr>
<td>Cartesian product</td>
<td>笛卡尔乘积</td>
<td>×</td>
<td><code>\times</code></td>
</tr>
<tr>
<td>Divide</td>
<td>除</td>
<td>÷</td>
<td><code>\div</code></td>
</tr>
<tr>
<td>Assignment</td>
<td>赋值</td>
<td>←</td>
<td><code>\leftarrow</code></td>
</tr>
<tr>
<td>And</td>
<td>条件并列</td>
<td>∧</td>
<td><code>\land</code> or <code>\vee</code></td>
</tr>
<tr>
<td>Negation</td>
<td>非</td>
<td>¬</td>
<td><code>\neg</code></td>
</tr>
<tr>
<td>Exist</td>
<td>存在</td>
<td>∃</td>
<td><code>\exists</code></td>
</tr>
<tr>
<td>For All</td>
<td>对所有</td>
<td>∀</td>
<td><code>\forall</code></td>
</tr>
<tr>
<td></td>
<td>下标文字</td>
<td>σusername</td>
<td><code>_&#123;\text&#123;&#125;&#125;</code></td>
</tr>
<tr>
<td></td>
<td>粗体文字</td>
<td>Gcount(*)</td>
<td><code>\textbf&#123;&#125;</code></td>
</tr>
<tr>
<td></td>
<td>长长长长括号</td>
<td>((((</td>
<td><code>\big( \Big( \bigg( \Bigg(</code></td>
</tr>
<tr>
<td></td>
<td>比较</td>
<td>&gt;≥&lt;≤≠</td>
<td><code>\gt \ge \lt \le \ne</code></td>
</tr>
</tbody>
</table>
<h3 id="递归定义">递归定义</h3>
<p>假设<span
class="math inline">\(E_1,E_2\)</span>都是关系代数表达式,显然该表达式的返回值是一个关系子集</p>
<p>那么关系代数表达式的表达式也是关系代数表达式</p>
<p>相当于整数的加减乘除等运算的结果还是整数,运算的结果还能参与运算</p>
<h3 id="mysql建表代码">mysql建表代码</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">EXISTS</span> instructor(</span><br><span class="line">    ID <span class="type">int</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    dept_name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    salary <span class="type">int</span>,</span><br><span class="line">    <span class="keyword">primary</span> key(id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> instructor(ID,name,dept_name,salary) <span class="keyword">values</span> (<span class="number">10101</span>,&quot;Srinivasan&quot;,&quot;Comp.Sci.&quot;,<span class="number">65000</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> instructor(ID,name,dept_name,salary) <span class="keyword">values</span> (<span class="number">12121</span>,&quot;Wu&quot;,&quot;Finance&quot;,<span class="number">90000</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> instructor(ID,name,dept_name,salary) <span class="keyword">values</span> (<span class="number">15151</span>,&quot;Mozart&quot;,&quot;Music&quot;,<span class="number">40000</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> instructor(ID,name,dept_name,salary) <span class="keyword">values</span> (<span class="number">22222</span>,&quot;Einstein&quot;,&quot;Physics&quot;,<span class="number">95000</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> instructor(ID,name,dept_name,salary) <span class="keyword">values</span> (<span class="number">32343</span>,&quot;El Said&quot;,&quot;History&quot;,<span class="number">60000</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> instructor(ID,name,dept_name,salary) <span class="keyword">values</span> (<span class="number">33456</span>,&quot;Gold&quot;,&quot;Physics&quot;,<span class="number">87000</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> instructor(ID,name,dept_name,salary) <span class="keyword">values</span> (<span class="number">45565</span>,&quot;Katz&quot;,&quot;Comp.Sci.&quot;,<span class="number">75000</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> instructor(ID,name,dept_name,salary) <span class="keyword">values</span> (<span class="number">58583</span>,&quot;Caliiferi&quot;,&quot;History&quot;,<span class="number">62000</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> instructor(ID,name,dept_name,salary) <span class="keyword">values</span> (<span class="number">76543</span>,&quot;Singh&quot;,&quot;Finance&quot;,<span class="number">80000</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> instructor(ID,name,dept_name,salary) <span class="keyword">values</span> (<span class="number">76766</span>,&quot;Crick&quot;,&quot;Biology&quot;,<span class="number">72000</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> instructor(ID,name,dept_name,salary) <span class="keyword">values</span> (<span class="number">83821</span>,&quot;Brandt&quot;,&quot;Comp.Sci.&quot;,<span class="number">92000</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> instructor(ID,name,dept_name,salary) <span class="keyword">values</span> (<span class="number">98345</span>,&quot;Kim&quot;,&quot;Elec.Eng.&quot;,<span class="number">80000</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> teaches(</span><br><span class="line">  ID <span class="type">int</span>,</span><br><span class="line">  course_id <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  sec_id <span class="type">int</span>,</span><br><span class="line">  semester <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  <span class="keyword">year</span> <span class="type">int</span>,</span><br><span class="line">  <span class="keyword">primary</span> key(course_id)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> teaches(ID,course_id,sec_id,semester,<span class="keyword">year</span>) <span class="keyword">values</span> (<span class="number">10101</span>,&quot;CS-101&quot;,<span class="number">1</span>,&quot;Fall&quot;,<span class="number">2017</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> teaches(ID,course_id,sec_id,semester,<span class="keyword">year</span>) <span class="keyword">values</span> (<span class="number">10101</span>,&quot;CS-315&quot;,<span class="number">1</span>,&quot;Spring&quot;,<span class="number">2018</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> teaches(ID,course_id,sec_id,semester,<span class="keyword">year</span>) <span class="keyword">values</span> (<span class="number">10101</span>,&quot;CS-347&quot;,<span class="number">1</span>,&quot;Fall&quot;,<span class="number">2017</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> teaches(ID,course_id,sec_id,semester,<span class="keyword">year</span>) <span class="keyword">values</span> (<span class="number">12121</span>,&quot;FIN-201&quot;,<span class="number">1</span>,&quot;Spring&quot;,<span class="number">2018</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> teaches(ID,course_id,sec_id,semester,<span class="keyword">year</span>) <span class="keyword">values</span> (<span class="number">15151</span>,&quot;MU-199&quot;,<span class="number">1</span>,&quot;Spring&quot;,<span class="number">2018</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> teaches(ID,course_id,sec_id,semester,<span class="keyword">year</span>) <span class="keyword">values</span> (<span class="number">22222</span>,&quot;PHY-101&quot;,<span class="number">1</span>,&quot;Fall&quot;,<span class="number">2017</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> teaches(ID,course_id,sec_id,semester,<span class="keyword">year</span>) <span class="keyword">values</span> (<span class="number">32343</span>,&quot;HIS-351&quot;,<span class="number">1</span>,&quot;Spring&quot;,<span class="number">2018</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> teaches(ID,course_id,sec_id,semester,<span class="keyword">year</span>) <span class="keyword">values</span> (<span class="number">45565</span>,&quot;CS-101&quot;,<span class="number">1</span>,&quot;Spring&quot;,<span class="number">2018</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> teaches(ID,course_id,sec_id,semester,<span class="keyword">year</span>) <span class="keyword">values</span> (<span class="number">45565</span>,&quot;CS-319&quot;,<span class="number">1</span>,&quot;Spring&quot;,<span class="number">2018</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> teaches(ID,course_id,sec_id,semester,<span class="keyword">year</span>) <span class="keyword">values</span> (<span class="number">76766</span>,&quot;BIO-101&quot;,<span class="number">1</span>,&quot;Summer&quot;,<span class="number">2017</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> teaches(ID,course_id,sec_id,semester,<span class="keyword">year</span>) <span class="keyword">values</span> (<span class="number">76766</span>,&quot;BIO-301&quot;,<span class="number">1</span>,&quot;Summer&quot;,<span class="number">2018</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> teaches(ID,course_id,sec_id,semester,<span class="keyword">year</span>) <span class="keyword">values</span> (<span class="number">83821</span>,&quot;CS-190&quot;,<span class="number">1</span>,&quot;Spring&quot;,<span class="number">2017</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> teaches(ID,course_id,sec_id,semester,<span class="keyword">year</span>) <span class="keyword">values</span> (<span class="number">83821</span>,&quot;CS-190&quot;,<span class="number">2</span>,&quot;Spring&quot;,<span class="number">2017</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> teaches(ID,course_id,sec_id,semester,<span class="keyword">year</span>) <span class="keyword">values</span> (<span class="number">83821</span>,&quot;CS-319&quot;,<span class="number">2</span>,&quot;Spring&quot;,<span class="number">2018</span>);</span><br><span class="line"><span class="keyword">insert</span> ignore <span class="keyword">into</span> teaches(ID,course_id,sec_id,semester,<span class="keyword">year</span>) <span class="keyword">values</span> (<span class="number">98345</span>,&quot;EE-181&quot;,<span class="number">1</span>,&quot;Spring&quot;,<span class="number">2017</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>后来这两个表有变动,但是变动不大</p>
<h3 id="选择sigma">选择<span class="math inline">\(\sigma\)</span></h3>
<p><span class="math display">\[
\sigma_{谓词条件}(关系表)
\]</span></p>
<p>从目标关系表中选出满足条件的元组行</p>
<p>比如对于以下troop表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----+--------+------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name   <span class="operator">|</span> age  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Tom    <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> Vader  <span class="operator">|</span>   <span class="number">40</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Anakin <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+------+</span></span><br></pre></td></tr></table></figure>
<p><span class="math display">\[
\sigma_{age&gt;20}(troop)
\]</span></p>
<p>就相当于</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> troop <span class="keyword">where</span> age<span class="operator">&gt;</span><span class="number">20</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name  <span class="operator">|</span> age  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> Vader <span class="operator">|</span>   <span class="number">40</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p><span class="math display">\[
select * from\ 关系表\ \color{red}where \color{white}\
关系谓词\longleftrightarrow\color{red}\sigma_{\color{white}关系谓词}\color{white}(关系表)
\]</span></p>
<p>这里关系谓词就是各种等于不等于,逻辑与或非</p>
<p><strong>SQL中的where才相当于关系代数中的<span
class="math inline">\(\sigma\)</span></strong></p>
<h3 id="投影pi">投影<span class="math inline">\(\Pi\)</span></h3>
<p>还是对于troop表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> troop;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name   <span class="operator">|</span> age  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Tom    <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> Vader  <span class="operator">|</span>   <span class="number">40</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Anakin <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>如果只想观察(id,name)属性,忽略age属性 <span class="math display">\[
\Pi_{id,name}(troops)
\]</span> 就相当于</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> id,name <span class="keyword">from</span> troop;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Tom    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> Vader  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Anakin <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p><span class="math display">\[
select\ 属性1,属性2{...}\ from (数据表)= \Pi_{属性1,属性2,...}(数据表)
\]</span></p>
<h3 id="组合使用pisigma">组合使用<span
class="math inline">\(\Pi,\sigma\)</span></h3>
<p>现在只关心军队中20岁以上士兵的(id,name),那么</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> id,name <span class="keyword">from</span> troop <span class="keyword">where</span> age<span class="operator">&gt;</span><span class="number">20</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> Vader <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>相当于 <span class="math display">\[
\Pi_{id,name}(\sigma_{age&gt;20}(troop))
\]</span> 由此可见,<span
class="math inline">\(\sigma\)</span>运算的结果仍然是一张表,可以在这个子表上再进行关系运算</p>
<h3 id="并cup">并<span class="math inline">\(\cup\)</span></h3>
<p>假设军官表长这样</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> officer;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+------+--------+-----------+-----------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name  <span class="operator">|</span> age  <span class="operator">|</span> gender <span class="operator">|</span> rank      <span class="operator">|</span> position  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+------+--------+-----------+-----------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Vader <span class="operator">|</span>   <span class="number">50</span> <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> marshal   <span class="operator">|</span> Army      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> Lisa  <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>      <span class="number">0</span> <span class="operator">|</span> colonel   <span class="operator">|</span> Regiment  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Rick  <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> major     <span class="operator">|</span> Battalion <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> Rex   <span class="operator">|</span>   <span class="number">25</span> <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> captain   <span class="operator">|</span> Company   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> Alpha <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> major     <span class="operator">|</span> Company   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">6</span> <span class="operator">|</span> Omega <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span>      <span class="number">0</span> <span class="operator">|</span> brigadier <span class="operator">|</span> Brigade   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+------+--------+-----------+-----------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>id,姓名,年龄,性别,均线,职位</p>
<p>现在想查询所有上校团长还有准将旅长的名字</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> name <span class="keyword">from</span> officer <span class="keyword">where</span> rank<span class="operator">=</span>&quot;colonel&quot; <span class="keyword">and</span> position<span class="operator">=</span>&quot;Regiment&quot; <span class="keyword">union</span> <span class="keyword">select</span> name <span class="keyword">from</span> officer <span class="keyword">where</span> rank<span class="operator">=</span>&quot;brigadier&quot; <span class="keyword">and</span> position<span class="operator">=</span>&quot;Brigade&quot;;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="operator">|</span> Lisa  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Omega <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>用关系代数表示就是 <span class="math display">\[
\Pi_{name}(\sigma_{rank=colonel\ \land\ position=Regiment}(officer)
)\cup\Pi_{name}(\sigma_{rank=brigadier\ \land\
position=Brigade}(officer) )
\]</span></p>
<p>这是在同一张表上联合查询,并运算也允许在两张表上联合查询,但是要求的是两种关系模型的属性个数,以及每个对等位置的属性的意义都是相同的.</p>
<p>比如</p>
<p>海军军官(id,姓名,年龄,性别,军衔,职位)</p>
<p>陆军军官(id,姓名,年龄,性别,军衔,职位)</p>
<p>这里海军军官和陆军军官两种关系就满足要求</p>
<p>可以联合查询海军军官里面的上校团长和陆军军官里面的上校团长</p>
<h3 id="差-">差<span class="math inline">\(-\)</span></h3>
<p>r,s表示两种关系模型,则r-s表示在r中但是不在s中的关系元组</p>
<blockquote>
<p>类似于集合的定义<span
class="math inline">\(A-B=A-AB=A(1-B)=A\overline{B}\)</span></p>
</blockquote>
<p>比如一般情况下,连长要上尉军衔的军官担任,现在要在军官表中查询军衔不是上尉的连长的名字</p>
<p>可以先查出连长名表,然后减去上尉名表</p>
<p>然而mysql不支持except和minus关键字,可以用not in代替</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> name <span class="keyword">from</span> officer</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">where</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> position<span class="operator">=</span>&quot;Company&quot; <span class="keyword">and</span> name <span class="keyword">not</span> <span class="keyword">in</span>(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     <span class="keyword">select</span> name <span class="keyword">from</span> officer</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     <span class="keyword">where</span> rank<span class="operator">=</span>&quot;captain&quot;</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="operator">|</span> Alpha <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>用关系代数表示相当于 <span class="math display">\[
\Pi_{name}(\sigma_{position =
Company}(officer))-\Pi_{name}(\sigma_{rank=captain}(officer))
\]</span> 由于这是在同一张表中查询的,可以不使用差集,都写在谓词里</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> name <span class="keyword">from</span> officer <span class="keyword">where</span> position<span class="operator">=</span>&quot;Company&quot; <span class="keyword">and</span> rank <span class="operator">!=</span>&quot;captain&quot;;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="operator">|</span> Alpha <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>用关系代数表示相当于 <span class="math display">\[
\Pi_{name}(\sigma_{position=Company\ \land\ rank=captain}(officer))
\]</span></p>
<h3 id="卷积times">卷积<span class="math inline">\(\times\)</span></h3>
<p>两个关系r,s的笛卡尔乘积<span class="math inline">\(r\times
s\)</span>意思是r和s的每一行都要组成一行填到新表里</p>
<p>假设现在要给所有连长任命连队,符合要求的军官有</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from officer where position=&quot;Company&quot;;</span><br><span class="line">+----+-------+------+--------+---------+----------+</span><br><span class="line">| id | name  | age  | gender | rank    | position |</span><br><span class="line">+----+-------+------+--------+---------+----------+</span><br><span class="line">|  4 | Rex   |   25 |      1 | captain | Company  |</span><br><span class="line">|  5 | Alpha |   23 |      1 | major   | Company  |</span><br><span class="line">+----+-------+------+--------+---------+----------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>所有连队有:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Companies;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name      <span class="operator">|</span> popularity <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> the Brave <span class="operator">|</span>        <span class="number">120</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> the Loyal <span class="operator">|</span>        <span class="number">130</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> the Fast  <span class="operator">|</span>        <span class="number">110</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+------------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>那么两个连长与三个连队之间的所有任命情况为</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> id,name,rank <span class="keyword">from</span> officer <span class="keyword">where</span> position<span class="operator">=</span>&quot;Company&quot;)<span class="keyword">as</span> Officer <span class="keyword">cross</span> <span class="keyword">join</span> companies;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+---------+----+-----------+------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name  <span class="operator">|</span> rank    <span class="operator">|</span> id <span class="operator">|</span> name      <span class="operator">|</span> popularity <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+---------+----+-----------+------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> Rex   <span class="operator">|</span> captain <span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> the Brave <span class="operator">|</span>        <span class="number">120</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> Alpha <span class="operator">|</span> major   <span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> the Brave <span class="operator">|</span>        <span class="number">120</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> Rex   <span class="operator">|</span> captain <span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> the Loyal <span class="operator">|</span>        <span class="number">130</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> Alpha <span class="operator">|</span> major   <span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> the Loyal <span class="operator">|</span>        <span class="number">130</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> Rex   <span class="operator">|</span> captain <span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> the Fast  <span class="operator">|</span>        <span class="number">110</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> Alpha <span class="operator">|</span> major   <span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> the Fast  <span class="operator">|</span>        <span class="number">110</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+---------+----+-----------+------------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这里<code>(select id,name,rank from officer where position="Company")as Officer</code>是给结果子表起了一个别名(alias),叫做Officer,不起别名会导致mysql报错</p>
</blockquote>
<p>写成关系代数就相当于 <span class="math display">\[
\Pi_{id,name,rank}(\sigma_{position=Company}(officer))\times\ companies
\]</span></p>
<blockquote>
<p>这种式子在计算的时候需要区分优先级,最开始计算的应该是 <span
class="math display">\[
A=\sigma_{position=Company}(officer)
\]</span></p>
<p>然后计算 <span class="math display">\[
B=\Pi_{id,name,rank}(A)
\]</span> 最后计算</p>
<p><span class="math display">\[
C=B\times companies
\]</span></p>
</blockquote>
<h3 id="更名rho">更名<span class="math inline">\(\rho\)</span></h3>
<p>实际上就是mysql中的alias别名 <span class="math display">\[
\rho_{alias(attr1,attr2,...)}(Expression)
\]</span> 其中attr1可以是原来的属性名,也可以是属性别名</p>
<p>在计算完Expression表达式之后,将返回的结果(一个关系子集)命名为alias</p>
<p>比如查询军官表中所有职位为连长的军官(id,name,rank),将该查询子表起名Companies</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> id <span class="keyword">as</span> compid,name,age <span class="keyword">as</span> comage <span class="keyword">from</span> officer <span class="keyword">as</span> Companies <span class="keyword">where</span> position<span class="operator">=</span>&quot;Company&quot;;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------+--------+</span></span><br><span class="line"><span class="operator">|</span> compid <span class="operator">|</span> name  <span class="operator">|</span> comage <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------+--------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">4</span> <span class="operator">|</span> Rex   <span class="operator">|</span>     <span class="number">25</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">5</span> <span class="operator">|</span> Alpha <span class="operator">|</span>     <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------+--------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>查询officer表中所有职位为连长的军官的(id,name,age),并且将属性改名为(compid,name,comage),将该查询子表改名为Companies</p>
<p>写成关系代数相当于 <span class="math display">\[
\rho_{Companies(compid,name,comage)}(\Pi_{id,name,rank}(\sigma_{position=Company}(officer)))
\]</span></p>
<h4
id="查询表中的最大薪水pi_salaryinstructor-pi_instructor.salarysigma_instructor.salaryd.salaryinstructortimes-rho_dinstructor">查询表中的最大薪水<span
class="math inline">\(\Pi_{salary}(instructor)-\Pi_{instructor.salary}(\sigma_{instructor.salary&lt;d.salary}(instructor\times
\rho_d(instructor)))\)</span></h4>
<p>假设有一张薪水表长这样</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> instructor;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+-----------+--------+</span></span><br><span class="line"><span class="operator">|</span> ID    <span class="operator">|</span> name       <span class="operator">|</span> dept_name <span class="operator">|</span> salary <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+-----------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">10101</span> <span class="operator">|</span> Srinivasan <span class="operator">|</span> Comp.Sci. <span class="operator">|</span>  <span class="number">65000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12121</span> <span class="operator">|</span> Wu         <span class="operator">|</span> Finance   <span class="operator">|</span>  <span class="number">90000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">15151</span> <span class="operator">|</span> Mozart     <span class="operator">|</span> Music     <span class="operator">|</span>  <span class="number">40000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">22222</span> <span class="operator">|</span> Einstein   <span class="operator">|</span> Physics   <span class="operator">|</span>  <span class="number">95000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">32343</span> <span class="operator">|</span> El Said    <span class="operator">|</span> History   <span class="operator">|</span>  <span class="number">60000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">33456</span> <span class="operator">|</span> Gold       <span class="operator">|</span> Physics   <span class="operator">|</span>  <span class="number">87000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">45565</span> <span class="operator">|</span> Katz       <span class="operator">|</span> Comp.Sci. <span class="operator">|</span>  <span class="number">75000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">58583</span> <span class="operator">|</span> Caliiferi  <span class="operator">|</span> History   <span class="operator">|</span>  <span class="number">62000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">76543</span> <span class="operator">|</span> Singh      <span class="operator">|</span> Finance   <span class="operator">|</span>  <span class="number">80000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+-----------+--------+</span></span><br><span class="line"><span class="number">9</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>现在要查询表中的最大薪水是多少</p>
<p>一种想法是,将该表与自己做笛卡乘,假设记作<span
class="math inline">\(A\times B\)</span></p>
<p>那么对于最高的薪水x,也就是不存在比他还高的薪水y</p>
<p>也就是说找不到<span
class="math inline">\(a.x&lt;b.y\)</span>此时<span
class="math inline">\(a.x\)</span>就是最高薪水</p>
<p>"找不到"这个不大好实现,但是"找到<span
class="math inline">\(a.x&gt;b.y\)</span>"容易实现,然后用薪水总集减去这"找到集"就是"找不到集"</p>
<p>书上是这样写的: <span class="math display">\[
\Pi_{salary}(instructor)-\Pi_{instructor.salary}(\sigma_{instructor.salary&lt;d.salary}(instructor\times
\rho_d(instructor)))
\]</span> <del>又臭又长</del></p>
<p>咋理解呢?自顶向下来看,</p>
<p>最顶层是两个关系集合的差,左边是instructor中的所有薪水组成的集合,</p>
<p>相当于<code>select salary from instructor</code></p>
<p>右侧是一大坨运算之后得到的表中instructor.salary组成的集合,下面着重分析一下右边干了啥,从最里层开始分析</p>
<p>自下往上来看</p>
<h5 id="最里层rho_dinstructor">最里层<span
class="math inline">\(\rho_{d}(instructor)\)</span></h5>
<p>将instructor表起了一个别名d,</p>
<p>相当于<code>select * from instructor as d</code></p>
<h5 id="第二层是instructortimes-rho_dinstructor">第二层是<span
class="math inline">\(instructor\times \rho_d(instructor)\)</span></h5>
<p>instructor关系集合自己和自己做了笛卡尔积,</p>
<blockquote>
<p>为啥要起别名d然后相乘呢?为了方便后来分别引用两个表的属性.</p>
</blockquote>
<p>相当于<code>select * from instructor as instructor cross join instructor as d;</code></p>
<blockquote>
<p>前面这个也必须起一个别名,mysql强制令任何过程子表都得有别名,之后最后打印到终端的结果表可以没有别名</p>
</blockquote>
<h5
id="第三层是sigma_instructor.salaryd.salaryinstructortimes-rho_dinstructor">第三层是<span
class="math inline">\(\sigma_{instructor.salary&lt;d.salary}(instructor\times
\rho_d(instructor))\)</span></h5>
<p>也就是在第二层的结果表中选择,</p>
<p>相当于<code>select * from instructor as d cross join instructor as instructor where instructor.salary &lt; d.salary;</code></p>
<h5
id="第四层是pi_instructor.salarysigma_instructor.salaryd.salaryinstructortimes-rho_dinstructor">第四层是<span
class="math inline">\(\Pi_{instructor.salary}(\sigma_{instructor.salary&lt;d.salary}(instructor\times
\rho_d(instructor)))\)</span></h5>
<p>在第三层的结果上,只保留<span
class="math inline">\(instructor.salary\)</span>这一个属性</p>
<p>相当于<code>select instructor.salary from instructor as d cross join instructor as instructor where instructor.salary &lt; d.salary;</code></p>
<h5
id="最高层是pi_salaryinstructor-pi_instructor.salarysigma_instructor.salaryd.salaryinstructortimes-rho_dinstructor">最高层是<span
class="math inline">\(\Pi_{salary}(instructor)-\Pi_{instructor.salary}(\sigma_{instructor.salary&lt;d.salary}(instructor\times
\rho_d(instructor)))\)</span></h5>
<p>对两个次高层的过程子表做差</p>
<p>相当于<code>select salary from instructor where salary not in(select instructor.salary from instructor as d cross join instructor as instructor where instructor.salary &lt; d.salary);</code></p>
<p>这么老太太的裹脚的一坨,竟然语法没错能查出来,有点儿离谱</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> salary <span class="keyword">from</span> instructor <span class="keyword">where</span> salary <span class="keyword">not</span> <span class="keyword">in</span>(<span class="keyword">select</span> instructor.salary <span class="keyword">from</span> instructor <span class="keyword">as</span> d <span class="keyword">cross</span> <span class="keyword">join</span> instructor <span class="keyword">as</span> instructor <span class="keyword">where</span> instructor.salary <span class="operator">&lt;</span> d.salary);</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span> salary <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">95000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="交cap">交<span class="math inline">\(\cap\)</span></h3>
<p>mysql中没有交运算关键字,可以使用in关键字代替</p>
<p>比如要查询instructor表中物理行业子表和薪水超过90k的人的子表,要求查询所有信息
<span class="math display">\[
\sigma_{dept\_name=Physics}(instructor)\cap
\sigma_{salary&gt;90000}(instructor)
\]</span></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> instructor <span class="keyword">where</span> dept_name<span class="operator">=</span>&quot;Physics&quot; <span class="keyword">and</span> ID <span class="keyword">not</span> <span class="keyword">in</span>(<span class="keyword">select</span> ID <span class="keyword">from</span> instructor <span class="keyword">where</span> salary<span class="operator">&gt;</span><span class="number">90000</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+-----------+--------+</span></span><br><span class="line"><span class="operator">|</span> ID    <span class="operator">|</span> name <span class="operator">|</span> dept_name <span class="operator">|</span> salary <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+-----------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">33456</span> <span class="operator">|</span> Gold <span class="operator">|</span> Physics   <span class="operator">|</span>  <span class="number">87000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+-----------+--------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>由于这是在同一张表中查询,可以将表交关系都放到谓词里 <span
class="math display">\[
\sigma_{dept\_name=Physics\ \land\ salary&gt;90000}(instructor)
\]</span></p>
<h3 id="自然连接join">自然连接<span
class="math inline">\(\Join\)</span></h3>
<h4 id="卷积运算实现自然连接功能">卷积运算实现自然连接功能</h4>
<p>假设有教讲师列表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> instructor;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+-----------+--------+</span></span><br><span class="line"><span class="operator">|</span> ID    <span class="operator">|</span> name       <span class="operator">|</span> dept_name <span class="operator">|</span> salary <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+-----------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">10101</span> <span class="operator">|</span> Srinivasan <span class="operator">|</span> Comp.Sci. <span class="operator">|</span>  <span class="number">65000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12121</span> <span class="operator">|</span> Wu         <span class="operator">|</span> Finance   <span class="operator">|</span>  <span class="number">90000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">15151</span> <span class="operator">|</span> Mozart     <span class="operator">|</span> Music     <span class="operator">|</span>  <span class="number">40000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">22222</span> <span class="operator">|</span> Einstein   <span class="operator">|</span> Physics   <span class="operator">|</span>  <span class="number">95000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">32343</span> <span class="operator">|</span> El Said    <span class="operator">|</span> History   <span class="operator">|</span>  <span class="number">60000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">33456</span> <span class="operator">|</span> Gold       <span class="operator">|</span> Physics   <span class="operator">|</span>  <span class="number">87000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">45565</span> <span class="operator">|</span> Katz       <span class="operator">|</span> Comp.Sci. <span class="operator">|</span>  <span class="number">75000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">58583</span> <span class="operator">|</span> Caliiferi  <span class="operator">|</span> History   <span class="operator">|</span>  <span class="number">62000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">76543</span> <span class="operator">|</span> Singh      <span class="operator">|</span> Finance   <span class="operator">|</span>  <span class="number">80000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">76766</span> <span class="operator">|</span> Crick      <span class="operator">|</span> Biology   <span class="operator">|</span>  <span class="number">72000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">83821</span> <span class="operator">|</span> Brandt     <span class="operator">|</span> Comp.Sci. <span class="operator">|</span>  <span class="number">92000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">98345</span> <span class="operator">|</span> Kim        <span class="operator">|</span> Elec.Eng. <span class="operator">|</span>  <span class="number">80000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+-----------+--------+</span></span><br><span class="line"><span class="number">12</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>还有课程列表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from teaches;</span><br><span class="line">+-------+-----------+--------+----------+------+</span><br><span class="line">| ID    | course_id | sec_id | semester | year |</span><br><span class="line">+-------+-----------+--------+----------+------+</span><br><span class="line">| 10101 | CS-101    |      1 | Fall     | 2017 |</span><br><span class="line">| 10101 | CS-315    |      1 | Spring   | 2018 |</span><br><span class="line">| 10101 | CS-347    |      1 | Fall     | 2017 |</span><br><span class="line">| 12121 | FIN-201   |      1 | Spring   | 2018 |</span><br><span class="line">| 15151 | MU-199    |      1 | Spring   | 2018 |</span><br><span class="line">| 22222 | PHY-101   |      1 | Fall     | 2017 |</span><br><span class="line">| 32343 | HIS-351   |      1 | Spring   | 2018 |</span><br><span class="line">| 45565 | CS-319    |      1 | Spring   | 2018 |</span><br><span class="line">| 76766 | BIO-101   |      1 | Summer   | 2017 |</span><br><span class="line">| 76766 | BIO-301   |      1 | Summer   | 2018 |</span><br><span class="line">| 83821 | CS-190    |      1 | Spring   | 2017 |</span><br><span class="line">| 98345 | EE-181    |      1 | Spring   | 2017 |</span><br><span class="line">+-------+-----------+--------+----------+------+</span><br><span class="line">12 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>teaches表中的ID是指任课教师编号,course_id才是这门课的编号</p>
<p>比如CS-101可能就是计导</p>
</blockquote>
<p>现在要查询Srinivasan老师教哪些课</p>
<p>显然可以使用笛卡尔积然后约束teaches.ID=instructor.ID</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> inst.name,teac.course_id</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">from</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     (<span class="keyword">select</span> ID,name <span class="keyword">from</span> instructor <span class="keyword">where</span> name<span class="operator">=</span>&quot;Srinivasan&quot;) <span class="keyword">as</span> inst</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>         <span class="keyword">cross</span> <span class="keyword">join</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     (<span class="keyword">select</span> ID,course_id <span class="keyword">from</span> teaches)<span class="keyword">as</span> teac</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">where</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     inst.ID<span class="operator">=</span>teac.ID;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-----------+</span></span><br><span class="line"><span class="operator">|</span> name       <span class="operator">|</span> course_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-----------+</span></span><br><span class="line"><span class="operator">|</span> Srinivasan <span class="operator">|</span> CS<span class="number">-101</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Srinivasan <span class="operator">|</span> CS<span class="number">-315</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Srinivasan <span class="operator">|</span> CS<span class="number">-347</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-----------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.03</span> sec)</span><br></pre></td></tr></table></figure>
<p>写成关系代数的形式 $$ <em>{inst.name,teac.course_id}(
</em>{inst.ID=teac.ID}(</p>
<pre><code>    \rho_&#123;inst&#125;(\Pi_&#123;name,ID&#125;(instructor))
        \times
    \rho_&#123;teac&#125;(\Pi_&#123;ID,course\_id&#125;(teaches))

)</code></pre>
<p>) $$</p>
<p>显然这样会造成很多不必要的计算,应该使用自然连接简化运算</p>
<h4 id="实际上的自然连接">实际上的自然连接</h4>
<p>使用卷积的时候,每个讲师会和每个课程组合一下,但是显然教物理的教不了金融</p>
<p>并且teaches表中的ID列已经给出了这门课又哪个老师教,使用卷积组合时除了老师ID=课老师ID这种组合是有效的,其他组合都是寂寞</p>
<p>应该只保留老师ID=课老师ID的组合,这就是自然连接了</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> name,course_id <span class="keyword">from</span> (instructor <span class="keyword">natural</span> <span class="keyword">join</span> teaches) <span class="keyword">where</span> instructor.name<span class="operator">=</span>&quot;Srinivasan&quot;;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-----------+</span></span><br><span class="line"><span class="operator">|</span> name       <span class="operator">|</span> course_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-----------+</span></span><br><span class="line"><span class="operator">|</span> Srinivasan <span class="operator">|</span> CS<span class="number">-101</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Srinivasan <span class="operator">|</span> CS<span class="number">-315</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Srinivasan <span class="operator">|</span> CS<span class="number">-347</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-----------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>写成关系代数就是 <span class="math display">\[
\Pi_{name,course\_id}(\sigma_{instructor.name=Srinivasan}(instructor\Join
teaches))
\]</span></p>
<h4 id="自然连接和卷积的关系">自然连接和卷积的关系</h4>
<p>设r,s是两个关系,<span class="math inline">\(r\Join
s\)</span>表示两个关系的自然连接,R,S分别表示两个关系的属性集合</p>
<p>总结一下自然连接应该怎么用低级的关系代数式表示</p>
<blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (instructor <span class="keyword">natural</span> <span class="keyword">join</span> teaches);</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+-----------+--------+-----------+--------+----------+------+</span></span><br><span class="line"><span class="operator">|</span> ID    <span class="operator">|</span> name       <span class="operator">|</span> dept_name <span class="operator">|</span> salary <span class="operator">|</span> course_id <span class="operator">|</span> sec_id <span class="operator">|</span> semester <span class="operator">|</span> <span class="keyword">year</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+-----------+--------+-----------+--------+----------+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">10101</span> <span class="operator">|</span> Srinivasan <span class="operator">|</span> Comp.Sci. <span class="operator">|</span>  <span class="number">65000</span> <span class="operator">|</span> CS<span class="number">-101</span>    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Fall     <span class="operator">|</span> <span class="number">2017</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">10101</span> <span class="operator">|</span> Srinivasan <span class="operator">|</span> Comp.Sci. <span class="operator">|</span>  <span class="number">65000</span> <span class="operator">|</span> CS<span class="number">-315</span>    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Spring   <span class="operator">|</span> <span class="number">2018</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">10101</span> <span class="operator">|</span> Srinivasan <span class="operator">|</span> Comp.Sci. <span class="operator">|</span>  <span class="number">65000</span> <span class="operator">|</span> CS<span class="number">-347</span>    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Fall     <span class="operator">|</span> <span class="number">2017</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12121</span> <span class="operator">|</span> Wu         <span class="operator">|</span> Finance   <span class="operator">|</span>  <span class="number">90000</span> <span class="operator">|</span> FIN<span class="number">-201</span>   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Spring   <span class="operator">|</span> <span class="number">2018</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">15151</span> <span class="operator">|</span> Mozart     <span class="operator">|</span> Music     <span class="operator">|</span>  <span class="number">40000</span> <span class="operator">|</span> MU<span class="number">-199</span>    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Spring   <span class="operator">|</span> <span class="number">2018</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">22222</span> <span class="operator">|</span> Einstein   <span class="operator">|</span> Physics   <span class="operator">|</span>  <span class="number">95000</span> <span class="operator">|</span> PHY<span class="number">-101</span>   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Fall     <span class="operator">|</span> <span class="number">2017</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">32343</span> <span class="operator">|</span> El Said    <span class="operator">|</span> History   <span class="operator">|</span>  <span class="number">60000</span> <span class="operator">|</span> HIS<span class="number">-351</span>   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Spring   <span class="operator">|</span> <span class="number">2018</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">45565</span> <span class="operator">|</span> Katz       <span class="operator">|</span> Comp.Sci. <span class="operator">|</span>  <span class="number">75000</span> <span class="operator">|</span> CS<span class="number">-319</span>    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Spring   <span class="operator">|</span> <span class="number">2018</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">76766</span> <span class="operator">|</span> Crick      <span class="operator">|</span> Biology   <span class="operator">|</span>  <span class="number">72000</span> <span class="operator">|</span> BIO<span class="number">-101</span>   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Summer   <span class="operator">|</span> <span class="number">2017</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">76766</span> <span class="operator">|</span> Crick      <span class="operator">|</span> Biology   <span class="operator">|</span>  <span class="number">72000</span> <span class="operator">|</span> BIO<span class="number">-301</span>   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Summer   <span class="operator">|</span> <span class="number">2018</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">83821</span> <span class="operator">|</span> Brandt     <span class="operator">|</span> Comp.Sci. <span class="operator">|</span>  <span class="number">92000</span> <span class="operator">|</span> CS<span class="number">-190</span>    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Spring   <span class="operator">|</span> <span class="number">2017</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">98345</span> <span class="operator">|</span> Kim        <span class="operator">|</span> Elec.Eng. <span class="operator">|</span>  <span class="number">80000</span> <span class="operator">|</span> EE<span class="number">-181</span>    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Spring   <span class="operator">|</span> <span class="number">2017</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+-----------+--------+-----------+--------+----------+------+</span></span><br><span class="line"><span class="number">12</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>mysql会自动搜索两个表中的相同属性,然后进行等值连接</p>
<p>比如有两张表<span
class="math inline">\(S(A,B,C),T(B,C,D)\)</span></p>
<p>此时<span class="math inline">\(S\Join
T=ST(A,B,C,D)\)</span>,mysql会考虑B,C都相同的元组合并成同一个元组,</p>
<p>如果<span class="math inline">\(\exist s(a,b,c,d)\in A,\forall
t_i(b_i,c_i,d_i)\in T,!(b=b_i \land
c=c_i)\)</span>则该S表中的s元组会被抛弃</p>
<p>同理适用于t</p>
<blockquote>
<p>说人话就是S,T表保留公共部分完全相同的表项进行合并</p>
<p>"公共部分"是指所有相同的列属性</p>
</blockquote>
</blockquote>
<p>那么有 <span class="math display">\[
r\Join s=\Pi_{R\cup
S}(\sigma_{r.a_1=s.a_1,r.a_2=s.a_2,...,r.a_n=s.a_n}(r\times s))
\]</span></p>
<p>其中<span class="math inline">\(a_i\in R\cap
S\)</span>表示r和s共有的属性</p>
<p>怎么理解这个公式呢?还是从下往上看这个公式</p>
<p>最里层<span class="math inline">\(r\times
s\)</span>,笛卡尔积,r到s所有行的组合都有了</p>
<p>第二层<span
class="math inline">\(\sigma_{r.a_1=s.a_1,r.a_2=s.a_2,...,r.a_n=s.a_n}(r\times
s)\)</span>,在第一层的计算结果表中,取出<span
class="math inline">\(r.a_1=s.a_1,r.a_2=s.a_2...\)</span>的行组成新的子表</p>
<p>第三层<span class="math inline">\(\Pi_{R\cup
S}(\sigma_{r.a_1=s.a_1,r.a_2=s.a_2,...,r.a_n=s.a_n}(r\times
s))\)</span>保留R和S所有属性</p>
<h3 id="赋值leftarrow">赋值<span
class="math inline">\(\leftarrow\)</span></h3>
<p>对于刚才的自然连接,可以使用赋值运算保存临时变量,分布计算 <span
class="math display">\[
\Pi_{name,course\_id}(\sigma_{instructor.name=Srinivasan}(instructor\Join
teaches))
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
temp1&amp;\leftarrow instructor\Join teaches\\
temp2&amp;\leftarrow \sigma_{instructor.name=Srinivasan}(temp1)\\
result&amp;\leftarrow \Pi_{name,course\_id}(temp2)
\end{aligned}
\]</span></p>
<p>但是在mysql上没有找到这种用法</p>
<h3 id="外连接">外连接</h3>
<p>自然连接时,如果s表中的某一项在r表中找不到共有属性完全相同的项则会被抛弃,而外连接将会保留s表中的这一项,并给他创建一个全空的r表对应项</p>
<p>举个例子说</p>
<p>教师表s中的教师可以分成教学的和不教学的两类</p>
<p>课程表t中的课程可以分成自习课和教学课两类</p>
<p><span class="math inline">\(s\Join
t\)</span>只会保留教课老师和教学课,还得是这个老师和教的课都存在,显然不教学的老师不会出现在结果里,自习课也不会出现在结果里</p>
<p>比如现有课程表和教师表</p>
<figure>
<img
src="https://raw.githubusercontent.com/DeutschBall/DeutschBall/main/WPS%E5%9B%BE%E7%89%87%E6%8B%BC%E5%9B%BE.png"
alt="左课程右教师" />
<figcaption aria-hidden="true">左课程右教师</figcaption>
</figure>
<p>SELF-0这课对应教师ID=0,不存在这个老师,意味着自习课,显然在自然连接的时候会被扬了</p>
<p>ID=33456这个Gold老师,在teaches课程表上没有任课记录,自然连接的时候也会被扬了</p>
<p>现在令l表示左表,也就是teaches;令r表示右表,也就是instructor</p>
<p>对于<span class="math inline">\(teaches \ opt \
instructor\)</span></p>
<p>如果是opt全外连接则谁也不会被扬了,</p>
<p>如果opt是左外连接则SELF-0留下,33456号教师扬了</p>
<p>如果opt是右外连接则SELF-0扬了,33456号教师留下</p>
<p>如果opt是全外连接则都留下</p>
<p>这三个在<span class="math inline">\(\LaTeX\)</span>中没有找到符号</p>
<h4 id="左外连接">左外连接<span class="math inline">\(⟕\)</span></h4>
<p>谁在左边谁全留下,右边的该扬就得扬</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> teaches <span class="keyword">as</span> l <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> instructor <span class="keyword">as</span> r <span class="keyword">ON</span> l.ID<span class="operator">=</span>r.ID;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-----------+--------+----------+------+-------+------------+-----------+--------+</span></span><br><span class="line"><span class="operator">|</span> ID    <span class="operator">|</span> course_id <span class="operator">|</span> sec_id <span class="operator">|</span> semester <span class="operator">|</span> <span class="keyword">year</span> <span class="operator">|</span> ID    <span class="operator">|</span> name       <span class="operator">|</span> dept_name <span class="operator">|</span> salary <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-----------+--------+----------+------+-------+------------+-----------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">10101</span> <span class="operator">|</span> CS<span class="number">-101</span>    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Fall     <span class="operator">|</span> <span class="number">2017</span> <span class="operator">|</span> <span class="number">10101</span> <span class="operator">|</span> Srinivasan <span class="operator">|</span> Comp.Sci. <span class="operator">|</span>  <span class="number">65000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">10101</span> <span class="operator">|</span> CS<span class="number">-315</span>    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Spring   <span class="operator">|</span> <span class="number">2018</span> <span class="operator">|</span> <span class="number">10101</span> <span class="operator">|</span> Srinivasan <span class="operator">|</span> Comp.Sci. <span class="operator">|</span>  <span class="number">65000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">10101</span> <span class="operator">|</span> CS<span class="number">-347</span>    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Fall     <span class="operator">|</span> <span class="number">2017</span> <span class="operator">|</span> <span class="number">10101</span> <span class="operator">|</span> Srinivasan <span class="operator">|</span> Comp.Sci. <span class="operator">|</span>  <span class="number">65000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12121</span> <span class="operator">|</span> FIN<span class="number">-201</span>   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Spring   <span class="operator">|</span> <span class="number">2018</span> <span class="operator">|</span> <span class="number">12121</span> <span class="operator">|</span> Wu         <span class="operator">|</span> Finance   <span class="operator">|</span>  <span class="number">90000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">15151</span> <span class="operator">|</span> MU<span class="number">-199</span>    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Spring   <span class="operator">|</span> <span class="number">2018</span> <span class="operator">|</span> <span class="number">15151</span> <span class="operator">|</span> Mozart     <span class="operator">|</span> Music     <span class="operator">|</span>  <span class="number">40000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">22222</span> <span class="operator">|</span> PHY<span class="number">-101</span>   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Fall     <span class="operator">|</span> <span class="number">2017</span> <span class="operator">|</span> <span class="number">22222</span> <span class="operator">|</span> Einstein   <span class="operator">|</span> Physics   <span class="operator">|</span>  <span class="number">95000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">32343</span> <span class="operator">|</span> HIS<span class="number">-351</span>   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Spring   <span class="operator">|</span> <span class="number">2018</span> <span class="operator">|</span> <span class="number">32343</span> <span class="operator">|</span> El Said    <span class="operator">|</span> History   <span class="operator">|</span>  <span class="number">60000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">45565</span> <span class="operator">|</span> CS<span class="number">-319</span>    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Spring   <span class="operator">|</span> <span class="number">2018</span> <span class="operator">|</span> <span class="number">45565</span> <span class="operator">|</span> Katz       <span class="operator">|</span> Comp.Sci. <span class="operator">|</span>  <span class="number">75000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">76766</span> <span class="operator">|</span> BIO<span class="number">-101</span>   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Summer   <span class="operator">|</span> <span class="number">2017</span> <span class="operator">|</span> <span class="number">76766</span> <span class="operator">|</span> Crick      <span class="operator">|</span> Biology   <span class="operator">|</span>  <span class="number">72000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">76766</span> <span class="operator">|</span> BIO<span class="number">-301</span>   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Summer   <span class="operator">|</span> <span class="number">2018</span> <span class="operator">|</span> <span class="number">76766</span> <span class="operator">|</span> Crick      <span class="operator">|</span> Biology   <span class="operator">|</span>  <span class="number">72000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">83821</span> <span class="operator">|</span> CS<span class="number">-190</span>    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Spring   <span class="operator">|</span> <span class="number">2017</span> <span class="operator">|</span> <span class="number">83821</span> <span class="operator">|</span> Brandt     <span class="operator">|</span> Comp.Sci. <span class="operator">|</span>  <span class="number">92000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">98345</span> <span class="operator">|</span> EE<span class="number">-181</span>    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Spring   <span class="operator">|</span> <span class="number">2017</span> <span class="operator">|</span> <span class="number">98345</span> <span class="operator">|</span> Kim        <span class="operator">|</span> Elec.Eng. <span class="operator">|</span>  <span class="number">80000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> SELF<span class="number">-0</span>    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Spring   <span class="operator">|</span> <span class="number">2018</span> <span class="operator">|</span>  <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>       <span class="operator">|</span> <span class="keyword">NULL</span>      <span class="operator">|</span>   <span class="keyword">NULL</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-----------+--------+----------+------+-------+------------+-----------+--------+</span></span><br><span class="line"><span class="number">13</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>33456号老师已经被扬了</p>
<p>写成关系代数就是 <span class="math display">\[
\sigma_{l.ID=r.ID}(\rho_l(teaches)⟕\rho_r(instructor))
\]</span></p>
<h4 id="右外连接">右外连接<span class="math inline">\(⟖\)</span></h4>
<p>谁在右边谁全留下,左边该扬就得扬</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> l.course_id,r.name <span class="keyword">from</span> teaches <span class="keyword">as</span> l <span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> instructor <span class="keyword">as</span> r <span class="keyword">ON</span> l.ID<span class="operator">=</span>r.ID;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+------------+</span></span><br><span class="line"><span class="operator">|</span> course_id <span class="operator">|</span> name       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+------------+</span></span><br><span class="line"><span class="operator">|</span> CS<span class="number">-101</span>    <span class="operator">|</span> Srinivasan <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CS<span class="number">-315</span>    <span class="operator">|</span> Srinivasan <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CS<span class="number">-347</span>    <span class="operator">|</span> Srinivasan <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FIN<span class="number">-201</span>   <span class="operator">|</span> Wu         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MU<span class="number">-199</span>    <span class="operator">|</span> Mozart     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> PHY<span class="number">-101</span>   <span class="operator">|</span> Einstein   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> HIS<span class="number">-351</span>   <span class="operator">|</span> El Said    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CS<span class="number">-319</span>    <span class="operator">|</span> Katz       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BIO<span class="number">-101</span>   <span class="operator">|</span> Crick      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BIO<span class="number">-301</span>   <span class="operator">|</span> Crick      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CS<span class="number">-190</span>    <span class="operator">|</span> Brandt     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> EE<span class="number">-181</span>    <span class="operator">|</span> Kim        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span>      <span class="operator">|</span> Gold       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span>      <span class="operator">|</span> Caliiferi  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span>      <span class="operator">|</span> Singh      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+------------+</span></span><br><span class="line"><span class="number">15</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>SELF-0号自习课已经被扬了</p>
<p>三个不任课的老师留下</p>
<p>写成关系代数的形式就是 <span class="math display">\[
\Pi_{l.course\_id,r.name}(\sigma_{l.ID=r.ID}(\rho_l(teaches)⟖\rho_r(instructor)))
\]</span></p>
<h4 id="全外连接">全外连接<span class="math inline">\(⟗\)</span></h4>
<p>mysql中没有全外连接</p>
<p>但是可以使用左外连接联合查询右外连接</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> l.course_id,r.name</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     <span class="keyword">from</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>         teaches <span class="keyword">as</span> l</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>             <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>         instructor <span class="keyword">as</span> r</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>             <span class="keyword">ON</span> l.ID<span class="operator">=</span>r.ID</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">union</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">select</span> l.course_id,r.name</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     <span class="keyword">from</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>         teaches <span class="keyword">as</span> l</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>             <span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>         instructor <span class="keyword">as</span> r</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>             <span class="keyword">ON</span> l.ID<span class="operator">=</span>r.ID</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> ;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+------------+</span></span><br><span class="line"><span class="operator">|</span> course_id <span class="operator">|</span> name       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+------------+</span></span><br><span class="line"><span class="operator">|</span> CS<span class="number">-101</span>    <span class="operator">|</span> Srinivasan <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CS<span class="number">-315</span>    <span class="operator">|</span> Srinivasan <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CS<span class="number">-347</span>    <span class="operator">|</span> Srinivasan <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FIN<span class="number">-201</span>   <span class="operator">|</span> Wu         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MU<span class="number">-199</span>    <span class="operator">|</span> Mozart     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> PHY<span class="number">-101</span>   <span class="operator">|</span> Einstein   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> HIS<span class="number">-351</span>   <span class="operator">|</span> El Said    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CS<span class="number">-319</span>    <span class="operator">|</span> Katz       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BIO<span class="number">-101</span>   <span class="operator">|</span> Crick      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BIO<span class="number">-301</span>   <span class="operator">|</span> Crick      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CS<span class="number">-190</span>    <span class="operator">|</span> Brandt     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> EE<span class="number">-181</span>    <span class="operator">|</span> Kim        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SELF<span class="number">-0</span>    <span class="operator">|</span> <span class="keyword">NULL</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span>      <span class="operator">|</span> Gold       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span>      <span class="operator">|</span> Caliiferi  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span>      <span class="operator">|</span> Singh      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+------------+</span></span><br><span class="line"><span class="number">16</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p><span class="math display">\[
\Pi_{l.course\_id,r.name}(\sigma_{l.ID=r.ID}(\rho_l(teaches)⟗\rho_r(instructor)))
\]</span></p>
<h3 id="除div">除<span class="math inline">\(\div\)</span></h3>
<p>设关系r的属性<span
class="math inline">\(R=(A_1,A_2,...,A_m,B_1,B_2,...,B_n)\)</span></p>
<p>设关系s的属性<span
class="math inline">\(S=(B_1,B_2,...,B_n)\)</span></p>
<blockquote>
<p>所谓关系就是表</p>
<p>所谓属性就是表的列</p>
</blockquote>
<p>则 <span class="math display">\[
r\div s=(A_1,A_2,...,A_m)
\]</span></p>
<p>严谨定义为 <span class="math display">\[
r\div s=\{t|t\in \Pi_{R-S}(r)\ \land\forall u\in s\rightarrow tu\in r\}
\]</span></p>
<blockquote>
<p>t元组的属性是R-S剩下的属性,</p>
<p>并且t和s中任何元组的积都属于r.</p>
<p>则t就是<span class="math inline">\(r\div s\)</span>集合的元素</p>
</blockquote>
<h3 id="练习">练习</h3>
<h4 id="练习1卷出最值">练习1卷出最值</h4>
<p>查出account表中最大(小)存款(balance)数</p>
<p><img
src="https://raw.githubusercontent.com/DeutschBall/DeutschBall/main/image-20220915002527616.png"
alt="image-20220915002527616" /> <span class="math display">\[
\begin{aligned}
最大存款数&amp;=\Pi_{balance}(account)-\Pi_{acnt.balance}(\sigma_{acnt.balance&lt;account.balance}(\rho_{acnt}(account)\times
account))\\
最小存款数&amp;=\Pi_{balance}(account)-\Pi_{account.balance}(\sigma_{acnt.balance&lt;account.balance}(\rho_{acnt}(account)\times
account))
\end{aligned}
\]</span> 用<span
class="math inline">\(\sigma_{acnt.balance&lt;account.balance}(\rho_{acnt}(account)\times
account)\)</span>这个选择蹉跎一下,就包含了所有前存款小于后存款的条目,</p>
<p>这些条目中,每一条都是acnt.balance作为前项也就是小的一项,account.balance作为后项也就是大的一项,</p>
<p>那么acnt.balance不含最大项,account.balance不含最小项</p>
<h4 id="练习2连卷转化">练习2连卷转化</h4>
<p>查出至少有一个账户上有多于700块钱存款的用户</p>
<figure>
<img
src="https://raw.githubusercontent.com/DeutschBall/DeutschBall/main/image-20220915000754242.png"
alt="image-20220915000754242" />
<figcaption aria-hidden="true">image-20220915000754242</figcaption>
</figure>
<p>用卷积做的话 <span class="math display">\[
\Pi_{customer\_name}(\sigma_{account.number=depositor.number}(\sigma_{account.balance&gt;700}(account)\times
depositor))
\]</span></p>
<p>用自然连接做的话 <span class="math display">\[
\Pi_{customer\_name}(\sigma_{account.balance&gt;700}(account\Join
depositor))
\]</span></p>
<h4 id="练习3卷出多个账户">练习3卷出多个账户</h4>
<p>查询至少有两个账户的用户</p>
<figure>
<img
src="https://raw.githubusercontent.com/DeutschBall/DeutschBall/main/image-20220915005408814.png"
alt="image-20220915005408814" />
<figcaption aria-hidden="true">image-20220915005408814</figcaption>
</figure>
<p><span class="math display">\[
\Pi_{customer\_name}(\sigma_{dpstr.customer\_name=depositer.custormer\_name\
\land \ dpstr.account\_number\ne
depositor.account\_number}(\rho_{dpstr}(depositer)\times depositer))
\]</span></p>
<h4 id="练习4先连后卷">练习4先连后卷</h4>
<p>查出至少在两个分行(branch)都有账户(account)的用户(customer)</p>
<figure>
<img
src="https://raw.githubusercontent.com/DeutschBall/DeutschBall/main/image-20220915000336679.png"
alt="image-20220915000336679" />
<figcaption aria-hidden="true">image-20220915000336679</figcaption>
</figure>
<p>需要注意的是,一个人可以在同一个支行有多个账号,只考虑查询账户数多于两个的用户不成立</p>
<p>显然先把两个表以account_number为公共属性,自然连接起来,对这个自然连接表进行卷积,就能蹉跎出同一个人的不同支行账户组合了
<span class="math display">\[
\Pi_{customer\_name}(\sigma_{l.custormer\_name=r.custormer\_name\land
l.branch\_name\ne r.branch\_name}(\rho_l(depositor \Join account)\times
\rho_r(depositor\Join account)))
\]</span></p>
<h4 id="练习5自然连接">练习5自然连接</h4>
<p>查找在布鲁克林市有账户的用户</p>
<figure>
<img
src="https://raw.githubusercontent.com/DeutschBall/DeutschBall/main/image-20220915002042041.png"
alt="image-20220915002042041" />
<figcaption aria-hidden="true">image-20220915002042041</figcaption>
</figure>
<p><span class="math display">\[
\Pi_{customer\_name}(\sigma_{branch\_city=Brooklyn}(account\Join
branch))
\]</span></p>
<blockquote>
<p>只要在是布鲁克林市有一个账户就可以了</p>
</blockquote>
<h4 id="练习6除法关系">练习6除法关系</h4>
<p>查找在布鲁克林市<strong>任意支行</strong>都有账户的用户</p>
<figure>
<img
src="https://raw.githubusercontent.com/DeutschBall/DeutschBall/main/image-20220915002042041.png"
alt="image-20220915002042041" />
<figcaption aria-hidden="true">image-20220915002042041</figcaption>
</figure>
<p><span class="math display">\[
\Pi_{customer\_name,branch\_name}(\sigma_{branch\_city=Brooklyn}(account\Join
branch))\div \Pi_{branch\_name}(\sigma_{branch\_city=Brooklyn}(branch))
\]</span></p>
<h2 id="关系代数表达式化简">关系代数表达式化简</h2>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag"># 数据库</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/09/12/windows%20XP%20notepad.exe%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/" rel="prev" title="windows XP notepad.exe逆向分析">
      <i class="fa fa-chevron-left"></i> windows XP notepad.exe逆向分析
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/09/17/windowsROP/" rel="next" title="windows初级ROP">
      windows初级ROP <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0%E4%B8%8Esql%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.</span> <span class="nav-text">关系代数与SQL语句</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B%E6%9C%AF%E8%AF%AD"><span class="nav-number">1.1.</span> <span class="nav-text">关系模型术语</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0"><span class="nav-number">1.2.</span> <span class="nav-text">关系代数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%92%E5%BD%92%E5%AE%9A%E4%B9%89"><span class="nav-number">1.2.1.</span> <span class="nav-text">递归定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql%E5%BB%BA%E8%A1%A8%E4%BB%A3%E7%A0%81"><span class="nav-number">1.2.2.</span> <span class="nav-text">mysql建表代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%89%E6%8B%A9sigma"><span class="nav-number">1.2.3.</span> <span class="nav-text">选择\(\sigma\)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%95%E5%BD%B1pi"><span class="nav-number">1.2.4.</span> <span class="nav-text">投影\(\Pi\)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E4%BD%BF%E7%94%A8pisigma"><span class="nav-number">1.2.5.</span> <span class="nav-text">组合使用\(\Pi,\sigma\)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%B6cup"><span class="nav-number">1.2.6.</span> <span class="nav-text">并\(\cup\)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%AE-"><span class="nav-number">1.2.7.</span> <span class="nav-text">差\(-\)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%B7%E7%A7%AFtimes"><span class="nav-number">1.2.8.</span> <span class="nav-text">卷积\(\times\)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%B4%E5%90%8Drho"><span class="nav-number">1.2.9.</span> <span class="nav-text">更名\(\rho\)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E8%A1%A8%E4%B8%AD%E7%9A%84%E6%9C%80%E5%A4%A7%E8%96%AA%E6%B0%B4pi_salaryinstructor-pi_instructor.salarysigma_instructor.salaryd.salaryinstructortimes-rho_dinstructor"><span class="nav-number">1.2.9.1.</span> <span class="nav-text">查询表中的最大薪水\(\Pi_{salary}(instructor)-\Pi_{instructor.salary}(\sigma_{instructor.salary&lt;d.salary}(instructor\times
\rho_d(instructor)))\)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9C%80%E9%87%8C%E5%B1%82rho_dinstructor"><span class="nav-number">1.2.9.1.1.</span> <span class="nav-text">最里层\(\rho_{d}(instructor)\)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E5%B1%82%E6%98%AFinstructortimes-rho_dinstructor"><span class="nav-number">1.2.9.1.2.</span> <span class="nav-text">第二层是\(instructor\times \rho_d(instructor)\)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E5%B1%82%E6%98%AFsigma_instructor.salaryd.salaryinstructortimes-rho_dinstructor"><span class="nav-number">1.2.9.1.3.</span> <span class="nav-text">第三层是\(\sigma_{instructor.salary&lt;d.salary}(instructor\times
\rho_d(instructor))\)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%AC%AC%E5%9B%9B%E5%B1%82%E6%98%AFpi_instructor.salarysigma_instructor.salaryd.salaryinstructortimes-rho_dinstructor"><span class="nav-number">1.2.9.1.4.</span> <span class="nav-text">第四层是\(\Pi_{instructor.salary}(\sigma_{instructor.salary&lt;d.salary}(instructor\times
\rho_d(instructor)))\)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9C%80%E9%AB%98%E5%B1%82%E6%98%AFpi_salaryinstructor-pi_instructor.salarysigma_instructor.salaryd.salaryinstructortimes-rho_dinstructor"><span class="nav-number">1.2.9.1.5.</span> <span class="nav-text">最高层是\(\Pi_{salary}(instructor)-\Pi_{instructor.salary}(\sigma_{instructor.salary&lt;d.salary}(instructor\times
\rho_d(instructor)))\)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%A4cap"><span class="nav-number">1.2.10.</span> <span class="nav-text">交\(\cap\)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E7%84%B6%E8%BF%9E%E6%8E%A5join"><span class="nav-number">1.2.11.</span> <span class="nav-text">自然连接\(\Join\)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%B7%E7%A7%AF%E8%BF%90%E7%AE%97%E5%AE%9E%E7%8E%B0%E8%87%AA%E7%84%B6%E8%BF%9E%E6%8E%A5%E5%8A%9F%E8%83%BD"><span class="nav-number">1.2.11.1.</span> <span class="nav-text">卷积运算实现自然连接功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E9%99%85%E4%B8%8A%E7%9A%84%E8%87%AA%E7%84%B6%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.2.11.2.</span> <span class="nav-text">实际上的自然连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E7%84%B6%E8%BF%9E%E6%8E%A5%E5%92%8C%E5%8D%B7%E7%A7%AF%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="nav-number">1.2.11.3.</span> <span class="nav-text">自然连接和卷积的关系</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B5%8B%E5%80%BCleftarrow"><span class="nav-number">1.2.12.</span> <span class="nav-text">赋值\(\leftarrow\)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.2.13.</span> <span class="nav-text">外连接</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B7%A6%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.2.13.1.</span> <span class="nav-text">左外连接\(⟕\)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%B3%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.2.13.2.</span> <span class="nav-text">右外连接\(⟖\)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%A8%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.2.13.3.</span> <span class="nav-text">全外连接\(⟗\)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%99%A4div"><span class="nav-number">1.2.14.</span> <span class="nav-text">除\(\div\)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%83%E4%B9%A0"><span class="nav-number">1.2.15.</span> <span class="nav-text">练习</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%83%E4%B9%A01%E5%8D%B7%E5%87%BA%E6%9C%80%E5%80%BC"><span class="nav-number">1.2.15.1.</span> <span class="nav-text">练习1卷出最值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%83%E4%B9%A02%E8%BF%9E%E5%8D%B7%E8%BD%AC%E5%8C%96"><span class="nav-number">1.2.15.2.</span> <span class="nav-text">练习2连卷转化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%83%E4%B9%A03%E5%8D%B7%E5%87%BA%E5%A4%9A%E4%B8%AA%E8%B4%A6%E6%88%B7"><span class="nav-number">1.2.15.3.</span> <span class="nav-text">练习3卷出多个账户</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%83%E4%B9%A04%E5%85%88%E8%BF%9E%E5%90%8E%E5%8D%B7"><span class="nav-number">1.2.15.4.</span> <span class="nav-text">练习4先连后卷</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%83%E4%B9%A05%E8%87%AA%E7%84%B6%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.2.15.5.</span> <span class="nav-text">练习5自然连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%83%E4%B9%A06%E9%99%A4%E6%B3%95%E5%85%B3%E7%B3%BB"><span class="nav-number">1.2.15.6.</span> <span class="nav-text">练习6除法关系</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8C%96%E7%AE%80"><span class="nav-number">1.3.</span> <span class="nav-text">关系代数表达式化简</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="dustball"
      src="https://raw.githubusercontent.com/DeutschBall/picbed/main/dustball.png">
  <p class="site-author-name" itemprop="name">dustball</p>
  <div class="site-description" itemprop="description">dustland</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">33</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">dustball</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  
  <script data-pjax>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="//cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script>
<script src="/js/algolia-search.js"></script>












<script data-pjax>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'dark',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


    <div id="pjax">
  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

    </div>
</body>
</html>
