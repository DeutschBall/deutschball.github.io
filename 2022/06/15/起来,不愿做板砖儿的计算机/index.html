<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Cascadia Code:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"deutschball.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"right","width":500,"display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"万一找到了呢","hits_empty":"你说的 ${query} 我怎么找不着呢 ","hits_stats":"找到了 ${hits} 个结果，用时 ${time} 毫秒"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="起来,不愿作板儿砖的计算机“pull oneself up by one’s bootstraps”拉着自己的鞋带站起来  BIOSBIOS做的事情  Power is turned on. The CPU hands control over to the BIOS. The BIOS runs a program called Power-On Self Test, which determi">
<meta property="og:type" content="article">
<meta property="og:title" content="起来,不愿作板儿砖的计算机">
<meta property="og:url" content="http://deutschball.github.io/2022/06/15/%E8%B5%B7%E6%9D%A5,%E4%B8%8D%E6%84%BF%E5%81%9A%E6%9D%BF%E7%A0%96%E5%84%BF%E7%9A%84%E8%AE%A1%E7%AE%97%E6%9C%BA/index.html">
<meta property="og:site_name" content="dustland">
<meta property="og:description" content="起来,不愿作板儿砖的计算机“pull oneself up by one’s bootstraps”拉着自己的鞋带站起来  BIOSBIOS做的事情  Power is turned on. The CPU hands control over to the BIOS. The BIOS runs a program called Power-On Self Test, which determi">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/439512-b9c6066addb32acd.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613140700106.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613141246521.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613142143514.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613143304212.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613151050418.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613151239709.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613153315480.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613153439605.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613210834456.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613153550753.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613204029245.png">
<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b3/Serial_port_(9-pin).jpg/170px-Serial_port_(9-pin).jpg">
<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/Parallel_computer_printer_port.jpg/150px-Parallel_computer_printer_port.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613210006072.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613210213455.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613210249009.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613110740974.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613114613846.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613113439425.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613113524034.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613113709933.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613211928369.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613212116779.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/loader_menu.gif">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220615000440311.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/bc74f5d963f0419aa3ae51d08950272e.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613232353523.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614112455326.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614111629831.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614160219999.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614114636880.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614151353806.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614152209611.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614153820258.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614160458438.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614161620001.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614162458403.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614162653873.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614162805804.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614162856400.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614162933671.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614165129321.png">
<meta property="og:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614235435725.png">
<meta property="article:published_time" content="2022-06-14T16:34:00.000Z">
<meta property="article:modified_time" content="2022-06-15T16:51:42.359Z">
<meta property="article:author" content="dustball">
<meta property="article:tag" content="linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/DeutschBall/test/master/439512-b9c6066addb32acd.png">

<link rel="canonical" href="http://deutschball.github.io/2022/06/15/%E8%B5%B7%E6%9D%A5,%E4%B8%8D%E6%84%BF%E5%81%9A%E6%9D%BF%E7%A0%96%E5%84%BF%E7%9A%84%E8%AE%A1%E7%AE%97%E6%9C%BA/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>起来,不愿作板儿砖的计算机 | dustland</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">dustland</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">dustball in dustland</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-archives">

    <a href="/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="algolia-results">
  <div id="algolia-stats"></div>
  <div id="algolia-hits"></div>
  <div id="algolia-pagination" class="algolia-pagination"></div>
</div>

      
    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/deutschball" class="github-corner" title="Follow me on GayHub" aria-label="Follow me on GayHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://deutschball.github.io/2022/06/15/%E8%B5%B7%E6%9D%A5,%E4%B8%8D%E6%84%BF%E5%81%9A%E6%9D%BF%E7%A0%96%E5%84%BF%E7%9A%84%E8%AE%A1%E7%AE%97%E6%9C%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/DeutschBall/picbed/main/dustball.png">
      <meta itemprop="name" content="dustball">
      <meta itemprop="description" content="dustland">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dustland">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          起来,不愿作板儿砖的计算机
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-06-15 00:34:00" itemprop="dateCreated datePublished" datetime="2022-06-15T00:34:00+08:00">2022-06-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-06-16 00:51:42" itemprop="dateModified" datetime="2022-06-16T00:51:42+08:00">2022-06-16</time>
              </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="起来-不愿作板儿砖的计算机"><a href="#起来-不愿作板儿砖的计算机" class="headerlink" title="起来,不愿作板儿砖的计算机"></a>起来,不愿作板儿砖的计算机</h1><p>“pull oneself up by one’s bootstraps”拉着自己的鞋带站起来</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/439512-b9c6066addb32acd.png"></p>
<h2 id="BIOS"><a href="#BIOS" class="headerlink" title="BIOS"></a>BIOS</h2><h3 id="BIOS做的事情"><a href="#BIOS做的事情" class="headerlink" title="BIOS做的事情"></a>BIOS做的事情</h3><blockquote>
<ol>
<li>Power is turned on.</li>
<li>The CPU hands control over to the BIOS.</li>
<li>The BIOS runs a program called Power-On Self Test, which determines how much memory the computer has and then confirms that critical low-level hardware is operating correctly. Any errors are indicated by sequences of audible beeps. After this, the BIOS disables all configurable devices.</li>
<li>The BIOS identifies all of the computer’s peripheral devices, such as hard drives and expansion cards. It first looks for plug-and-play devices and assigns a number to each, but it doesn’t enable the devices at this time.</li>
<li>The BIOS locates the primary boot or initial program load (IPL) device. This is usually a storage device such as a hard drive, floppy drive or CD-ROM that holds the operating system, but it can be a network card connected to a server. The BIOS also locates all of the system’s secondary IPL devices.</li>
<li>The BIOS builds a system resource table, assigning conflict-free resources according to which devices it found and the configuration data stored in nonvolatile RAM.</li>
<li>It selects and enables the primary input (keyboard) and output (monitor) devices, so that if trouble occurs during the boot process, the BIOS can display a recovery screen and allow the user to select a stored configuration of system settings that are known to work. The BIOS captured these settings the last time the computer booted successfully, and it stores them in nonvolatile RAM.</li>
<li>It scans for non-plug-and-play devices, including the Peripheral Component Interconnect (PCI) bus, and adds data from their ROMs to its resource table.</li>
<li>The BIOS resolves device conflicts and configures the chosen boot device.</li>
<li>It enables plug-and-play devices by calling their option ROMs with appropriate parameters.</li>
<li>It starts the bootstrap loader. If, for some reason, the default IPL fails to load the operating system, the BIOS tries the next IPL device in the list.</li>
<li>The IPL device loads the operating system into memory.</li>
<li>The BIOS hands over control to the operating system, which may make other resource assignments.</li>
</ol>
</blockquote>
<p>1.上电</p>
<p>2.CPU将控制交给BIOS</p>
<p>3.BIOS开始上电自检,用来检查计算机内存大小,检查底层硬件是否正常运作.</p>
<p>只要有错就用蜂鸣器发出相应的叫声.</p>
<p>此后,BIOS禁用所有可配置设备(刚才检查的时候算是暂时启用了一下)</p>
<blockquote>
<p>我装在commando上的kali物理机每次开机都会用最大声音”Bee”一下,不太聪明的亚子</p>
</blockquote>
<p>4.BIOS识别计算机的所有外设,比如硬件驱动器和拓展卡(比如独立网卡独立显卡).</p>
<p>BIOS首先搜索所有即插即用式设备并为每个设备<strong>编号</strong>,但是此时并不将这些设备使能</p>
<p>5.BIOS定位主引导程序或者初始化加载程序设备.这种设备通常是一个存储设备比如硬盘,软盘,或者光驱,该设备上应当编程有操作系统,该设备甚至还可以是连接到一台服务器的网卡(这个有点离谱了)</p>
<p>6.BIOS 建立一张系统资源表，根据它找到的设备和存储在非易失性 RAM 中的配置数据分配无冲突资源。</p>
<p>7.BIOS使能基本输入(键盘)和输出(显示器)设备,如此当此后的启动过程中万一发生错误,BIOS可以打印打印恢复选项屏幕,并且让用户选择一个系统设定,然后BIOS遵旨继续执行.</p>
<p>BIOS会保存最后一次计算机成功启动时的设定,用那一次的设定进行恢复,这些设置被保存在非易失性RAM中</p>
<p>8.BIOS扫描所有<strong>非</strong>即插即用式设备,包括外设总线,并将这些设备的ROM中的数据添加到刚才建立的资源表中</p>
<p>9.BIOS解决设备冲突,确定boot所在的设备</p>
<p>10.BIOS通过使用适当参数,调用即插即用式设备的选项ROM,使能这些设备</p>
<p>11.BIOS启动bootstrap loader.</p>
<p>如果默认的IPL(InitialProgramLoader)(第9步设置的设备)不能装载操作系统,则BIOS尝试列表中的下一个IPL设备</p>
<p>12.IPL设备将操作系统装载进入内存</p>
<p>13.控制权交给操作系统,操作系统将进行其他资源分配</p>
<p>到此计算机启动完毕,BIOS完成使命</p>
<h3 id="BIOS设置"><a href="#BIOS设置" class="headerlink" title="BIOS设置"></a>BIOS设置</h3><h4 id="Main视图"><a href="#Main视图" class="headerlink" title="Main视图"></a>Main视图</h4><p>在我的ubuntu10.04 虚拟机上,开机的时候根据提示按下F2就可以进入BIOS选择阶段</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613140700106.png" alt="image-20220613140700106"></p>
<p>可见BIOS这么小的系统也已经图形化了</p>
<p>在Main视图下,可以修改系统日期时间</p>
<h5 id="Legacy-Diskette"><a href="#Legacy-Diskette" class="headerlink" title="Legacy Diskette"></a>Legacy Diskette</h5><p>设置软驱,都2202年了,不会有人还在用软驱吧,不管他了</p>
<h5 id="Primary-Second-Master-Slave"><a href="#Primary-Second-Master-Slave" class="headerlink" title="Primary&#x2F;Second Master&#x2F;Slave"></a>Primary&#x2F;Second Master&#x2F;Slave</h5><p>Primary Master&#x2F;Slave不是”主要大师&#x2F;奴隶”,是设置主IDE的主从通道</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613141246521.png" alt="image-20220613141246521"></p>
<p>IDE是啥?Integrated Drive Electronics,”把控制器和盘体集成的硬盘驱动器”</p>
<p>我不想下到硬件看看接口是什么样的了,就认为IDE是接硬盘的</p>
<p>如果IDE硬盘接到IDE通道的主通道(Primary)则BIOS将其作为引导盘</p>
<h5 id="Keyboard-Features"><a href="#Keyboard-Features" class="headerlink" title="Keyboard Features"></a>Keyboard Features</h5><p>“键盘特性”</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613142143514.png" alt="image-20220613142143514"></p>
<p>NumLock</p>
<p>里面有一个NumLock,数字锁,也就是键盘上最右边的数字小键盘锁,Off则开机自动关闭,不让用数字键,On则开机自动开启.即使这里是Off,也可以在开机时自己按键盘上的NumLock改变状态</p>
<p>Keyboard auto-repeat delay: [1&#x2F;2 sec]</p>
<p>考虑这么一长串字符你会怎么输入<code>aaaaaaaaaaaaaaaaaaa</code>,是不是按住a一直不放.</p>
<p>有没有注意过,但是按一下a,只会输出一个a,即使手稍微慢一点,也是只会输出一个a,并没有趁机写好几个a,从单输入第一个a到计算机认为需要连续获取输入之间的时间就是这个设置,</p>
<p>这里设为1&#x2F;2秒,即按下a之后不松开,过半秒之后就获取一长串输入</p>
<p>Keyboard auto-repeat rate: [30&#x2F;sec]</p>
<p>这个是啥呢?在键盘开始一长串输入后,每秒内输入几个a呢?100个?10个?1000个?</p>
<p>如果是1000,那么一旦Keyboard auto-repeat delay开关被打开,则眨眼间写入了百八十个a,写太多了,又要长按Backspace退格删除,Keyboard auto-repeat delay开关又被打开,呼哧一下删了百八十个a,甚至之前写的东西也退掉了.</p>
<p>显然1000这个数灵敏度太高,在我的windows上大约是20个左右,确切是多少我也不知道,重新开机看看吗,那个时候又没法截图</p>
<p>在这个ubuntu虚拟机上可以看见是30个</p>
<p>这里三个设置是根据用户习惯设置的,为人性化设置的</p>
<h5 id="Memory"><a href="#Memory" class="headerlink" title="Memory"></a>Memory</h5><p>然后展示了两个内存</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613143304212.png" alt="image-20220613143304212"></p>
<p>就让看看,根本不让改</p>
<p>两个内存分别是啥呢?</p>
<p>去中文站点儿查,就给说”System Memory是系统内存”,这傻子都会翻译还tm用你说,什么系统的内存啊?</p>
<h5 id="Boot-time-Diagnositc-Screen"><a href="#Boot-time-Diagnositc-Screen" class="headerlink" title="Boot-time Diagnositc Screen"></a>Boot-time Diagnositc Screen</h5><p>启动时诊断屏幕,这是个啥呢?</p>
<p>给他改成Enable然后重启看看,开机的时候会有一两秒的这个页面</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613151050418.png" alt="image-20220613151050418"></p>
<p>没有错误的就”Passed”或者”initialized”</p>
<h4 id="Advanced视图"><a href="#Advanced视图" class="headerlink" title="Advanced视图"></a>Advanced视图</h4><p>“高级”</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613151239709.png" alt="image-20220613151239709"></p>
<h5 id="Multiprocessor-Specification"><a href="#Multiprocessor-Specification" class="headerlink" title="Multiprocessor Specification"></a>Multiprocessor Specification</h5><p>“多处理器规范”</p>
<p>参考</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/MultiProcessor_Specification">MultiProcessor Specification - Wikipedia</a></p>
<p><a target="_blank" rel="noopener" href="https://pdos.csail.mit.edu/6.828/2008/readings/ia32/MPspec.pdf">MultiProcessor Specification (mit.edu)</a></p>
<blockquote>
<p>The <strong>MultiProcessor Specification</strong> (<strong>MPS</strong>) for the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/X86_architecture">x86 architecture</a> is an <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Open_standard">open standard</a> describing enhancements to both <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Operating_system">operating systems</a> and <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Firmware">firmware</a>, which will allow them to work with x86-compatible processors in a <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Multiprocessing">multi-processor</a> configuration. MPS covers <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Advanced_Programmable_Interrupt_Controller">Advanced Programmable Interrupt Controller</a> (APIC) architectures.</p>
<p>Version 1.1 of the specification was released on April 11, 1994. Version 1.4 of the specification was released on July 1, 1995, which added extended configuration tables to improve support for multiple PCI bus configurations and improve expandability.</p>
<p>The <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Linux_kernel">Linux kernel</a> and <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/FreeBSD">FreeBSD</a> are known to support the Intel MPS. <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Windows_NT">Windows NT</a> are known to support MPS 1.1 and <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Windows_2000">Windows 2000</a> or higher are known to support MPS 1.4. <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/OS/2">OS&#x2F;2</a> are known to support MPS 1.1 only. <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Mac_OS_X">Mac OS X</a> are known to support MPS 1.4 only.</p>
</blockquote>
<p>针对 x86架构的 MultiProcessor 规范(MPS)是一个开放标准，描述了对操作系统和固件的增强，这将允许它们在多处理器配置中与 x86兼容的处理器一起工作。</p>
<p>1.1版本于1994年4月11日发布。1.4版本于1995年7月1日发布，它添加了扩展配置表，以改进对多个 PCI 总线配置的支持，并提高可扩展性。</p>
<p>Linux内核和FreeBSD都是支持英特尔MPS的,</p>
<p>WindowsNT支持1.1版本</p>
<p>Windows2000以及更高版本系统支持1.4版本</p>
<p>多处理器规定,推测和解决多处理器对总线的竞争等等事务有关,还需要进一步阅读intel官方文件</p>
<h5 id="Installed-O-S"><a href="#Installed-O-S" class="headerlink" title="Installed O&#x2F;S"></a>Installed O&#x2F;S</h5><p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613153315480.png" alt="image-20220613153315480"></p>
<p>计算机启动到此时,并没有装载操作系统,如果有多系统的话,是时候做出选择了</p>
<h5 id="Reset-Configuration-Data"><a href="#Reset-Configuration-Data" class="headerlink" title="Reset Configuration Data:"></a>Reset Configuration Data:</h5><p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613153439605.png" alt="image-20220613153439605"></p>
<p>重设,在BIOS上做出的修改全都改回去?</p>
<p>如果真的是这个功能,那么Exit是干啥用的</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613210834456.png" alt="image-20220613210834456"></p>
<h5 id="Cache-Memory"><a href="#Cache-Memory" class="headerlink" title="Cache Memory"></a>Cache Memory</h5><p>内存的高速缓存</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613153550753.png" alt="image-20220613153550753"></p>
<p>第一个选项是选择启动还是关闭内存到CPU之间的高速缓存</p>
<p>第二个选项是系统总线的高速缓存,</p>
<p>…</p>
<h5 id="I-O-Device-Configuration"><a href="#I-O-Device-Configuration" class="headerlink" title="I&#x2F;O Device Configuration"></a>I&#x2F;O Device Configuration</h5><p>“输入输出设备配置”</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613204029245.png" alt="image-20220613204029245"></p>
<p>Serial port:串行通信接口,通过该接口,信息只能按顺序,一个一个比特传输</p>
<p>比如</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b3/Serial_port_(9-pin).jpg/170px-Serial_port_(9-pin).jpg" alt="DE-9 公口"></p>
<p>Parallel port:并行通信接口,一次性并行传送多个比特</p>
<p>比如</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/Parallel_computer_printer_port.jpg/150px-Parallel_computer_printer_port.jpg" alt="DB-25 母口"></p>
<p>Floppy disk controller,软盘控制器</p>
<p>I&#x2F;O Device Configuration就是修改这些接口是否使能,信息传送方向等</p>
<h5 id="Large-Disk-Access-Mode"><a href="#Large-Disk-Access-Mode" class="headerlink" title="Large Disk Access Mode"></a>Large Disk Access Mode</h5><p>大硬盘访问模式</p>
<blockquote>
<p>关于硬盘模式</p>
<p>参考<a target="_blank" rel="noopener" href="https://www.muzijie.com/a1/43w5o5m3.html">BIOS设置硬盘工作模式 - 木子杰软件教程 (muzijie.com)</a></p>
<p>NORMAL普通模式是最早的IDE方式。在此方式下对硬盘访问时,BIOS和IDE控制器对参数不作任何转换。</p>
<p>该模式支持的最大柱面数为1024,最大磁头数为16,最大扇区数为63,每扇区字节数为 512。因此支持最大硬盘容量为：$512×63×16×1024&#x3D;528MB$。</p>
<p>在此模式下即使硬盘的实际物理容量更大,但可访问的硬盘空间也只能是528MB。</p>
<p>LBA(Logical Block Addressing)逻辑块寻址模式。</p>
<p>这种模式所管理的硬盘空间突破了528KB 的瓶颈,可达8.4GB。</p>
<p>在LBA模式下,设置的柱面、磁头、扇区等参数并不是实际硬盘的物理参数。</p>
<p>在访问硬盘时,由IDE控制器把由柱面、磁头、扇区等参数确定的逻辑地址转换为实际硬盘的物理地址。</p>
<p>在LBA模式下,可设置的最大磁头数为255,其余参数与普通模式相同。</p>
<p>由此可计算出可访问的硬盘容量为:$512×63×255×1024&#x3D;8.4GB$。</p>
<p>LARGE大硬盘模式。当硬盘的柱面超过1024而又不为LBA支持时可采用此种模式。</p>
<p>LARGE模式采取的方法是把柱面数除以2,把磁头数乘以2,其结果总容量不变。</p>
<p>例如,在NORMAL模式下柱面数为1220,磁头数为16,进入LARGE模式则柱面数为610,磁头数为32。</p>
<p>这样在DOS看来柱面数小于1024,即可正常工作。目前基本上只有LBA有实际意义了。</p>
</blockquote>
<h5 id="Local-Bus-IDE-adapter"><a href="#Local-Bus-IDE-adapter" class="headerlink" title="Local Bus IDE adapter"></a>Local Bus IDE adapter</h5><p>局部总线IDE适配器</p>
<blockquote>
<p>随着CPU的飞速发展, 总线的低传输速率与微处理器的高处理速度不能同步, </p>
<p>造成硬盘、图形卡和其它高速外设只能通过一个狭窄而缓慢的瓶颈发送和接收数据,</p>
<p>从而严重影响了CPU高性能的充分发挥, 工业界因此又发展了局域总线(Local Bus)的新技术.</p>
<p>局域总线是在CPU总线与ISA或EISA总线之间新增加的一级总线. </p>
<p>它独立于CPU的结构, 与CPU的时钟频率无关, 使总线形成了一种独特的中间缓冲器. </p>
<p>一些高速外设, 如网卡和硬盘适配器等, 可以从ISA总线上卸下, </p>
<p><strong>通过局域总线直接挂接到CPU总线上, 从而解决了低速总线在高速微处理器和高速外设之间形成的瓶颈.</strong></p>
<p>什么是总线、总线的类型、局部总线、局部总线类型和什么是接口方式？什么是IDE？什么是SCSI？</p>
</blockquote>
<h5 id="Advanced-Chipset-Control"><a href="#Advanced-Chipset-Control" class="headerlink" title="Advanced Chipset Control"></a>Advanced Chipset Control</h5><p>“高级芯片控制”</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613210006072.png" alt="image-20220613210006072"></p>
<p>我是真的一点儿看不懂了</p>
<h4 id="Security视图"><a href="#Security视图" class="headerlink" title="Security视图"></a>Security视图</h4><p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613210213455.png" alt="image-20220613210213455"></p>
<p>设置密码用的</p>
<h4 id="Boot"><a href="#Boot" class="headerlink" title="Boot"></a>Boot</h4><p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613210249009.png" alt="image-20220613210249009"></p>
<p>用+或者-调整设备顺序</p>
<p>这里就是”9.BIOS解决设备冲突,确定boot所在的设备”需要设置的</p>
<p>如果使用U盘作为安装盘,则BOOT中USB串行通用接口设置到最前</p>
<p>在物理机上如果U盘设置到磁盘的后面,BIOS会从磁盘启动,如果磁盘中之前有装好的操作系统,则BIOS将会唤醒那个操作系统</p>
<p>如果磁盘中没有操作系统则BIOS重新尝试从U盘启动</p>
<h2 id="主引导记录MBR"><a href="#主引导记录MBR" class="headerlink" title="主引导记录MBR"></a>主引导记录MBR</h2><p>在BIOS boot视图下,我们设置了启动顺序</p>
<p>现在,BIOS按照该顺序给控制权</p>
<p>控制交给第一个存储设备,CPU读取该设备最前面512字节</p>
<p>如果该设备的最后两个字节为<code>0x55 AA</code>则表明这个设备可以用于启动操作系统.</p>
<p>否则这个设备白搭,控制交给下一个设备</p>
<h3 id="磁盘上的主引导记录"><a href="#磁盘上的主引导记录" class="headerlink" title="磁盘上的主引导记录"></a>磁盘上的主引导记录</h3><p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613110740974.png" alt="MOS-磁盘文件系统布局"></p>
<p>整个磁盘只有一个MBR(master boot record)主引导记录,一个分区表(分区表是MBR的一部分)</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613114613846.png" alt="MBR结构">最开始的218个字节就是<code>Bootstrap code area</code></p>
<p>后面有多个磁盘分区,每个分区在分区表中都有一条记录,记录该分区的开始与结束</p>
<p>这里”分区”在我们小打小闹儿的笔记本子上就是指卷(简单卷)</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613113439425.png" alt="image-20220613113439425"></p>
<p>比如我的电脑512G的固态硬盘被分成三个卷</p>
<p>MOS上关于这部分的描述十分滴珍贵,写的是汉字但是就是不说人话</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613113524034.png" alt="image-20220613113524034"></p>
<p>从”表中的一个分区被标记为活动分区”这句开始,我就不知道它在说什么了</p>
<p><strong>活动分区</strong>是什么,不给说,查了百科才知道</p>
<blockquote>
<p>活动分区是计算机系统分区，启动操作系统的文件都装在这个分区，Windows 系统下一般被默认为C盘。</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613113709933.png" alt="image-20220613113709933"></p>
</blockquote>
<p>在我的linux虚拟机上观察磁盘的前512个字节</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613211928369.png" alt="image-20220613211928369"></p>
<p>使用dd命令将磁盘的前512个字节备份到虚拟机和Executor本机的共享文件夹下面,然后在本机上用010editor打开刚才导出的备份文件</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613212116779.png" alt="MBR on Linux"></p>
<p>最后两个字节是<code>0x 55 AA</code>表明该512个字节为MBR</p>
<p>从右侧的Hex视图可以看出有一些有意义的字节比如</p>
<p>GRUB,Hard Disk.Read.Error等等</p>
<p>猜测MBR在执行的时候会说一些话,可能就会说这里的ASCII编码</p>
<p>MBR的前466个字节是机器码,boot loader,启动引导程序,在我的虚拟机上即grub程序</p>
<p>第447到510字节是分区表,作用是将硬盘分成不同卷</p>
<p>511到512是标志主引导记录的魔数(0x55 AA)</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/loader_menu.gif" alt="启动管理程序的菜单功能与控制权转交功能示意图"></p>
<p>在MOS给出的磁盘文件系统布局图上,可以发现每个磁盘分区最开始都有一个引导块,这个引导块中也可以有grub程序</p>
<p>主引导块之所以叫做”主”,是因为它是BIOS默认调用的引导块,并且主引导块可以选择让权,即把引导工作让给其他磁盘分区中的引导块完成</p>
<p>一般windows系统的主引导块没有这个作用,linux有,而安装多系统的时候主引导块会相互覆盖</p>
<p>因此应该首先安装windows系统然后安装linux系统,如此主引导块就可以选择让权或者直接引导了</p>
<h2 id="Grub"><a href="#Grub" class="headerlink" title="Grub"></a>Grub</h2><p>一是满足我对MBR干了什么的好奇心,而是复习一下计组8086上的汇编语言,我们对Grub进行反汇编分析</p>
<p>我太想知道这短短的466字节机器码,都干了什么了,他们是不是汇编语言或者C语言编译成的机器码呢?</p>
<h3 id="两个阶段"><a href="#两个阶段" class="headerlink" title="两个阶段"></a>两个阶段</h3><p>第一阶段:</p>
<p>boot loader的主程序需要写在主引导分区或者其他磁盘分区的引导块里.</p>
<p>但引导块太小了,只能放下boot loader的最小主程序,相关配置在第二阶段完成</p>
<p>第二阶段:</p>
<p>grub的相关配置都在<code>/boot/grub</code>下面放着</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220615000440311.png" alt="image-20220615000440311"></p>
<p>该目录下面是grub配置文件grub.cfg以及各种文件系统定义</p>
<blockquote>
<p>grub的配置文件不光有<code>grub.cfg</code></p>
<p>redhat,ubuntu等等各种系统的grub配置文件叫法不一样</p>
<p>在我的ubuntu10.04虚拟机上配置文件是grub.cfg</p>
</blockquote>
<h3 id="反汇编分析"><a href="#反汇编分析" class="headerlink" title="反汇编分析"></a>反汇编分析</h3><p>查阅了万能的网友的博客之后,linux上的nasm可以反编译</p>
<p>用我本机上的kali子系统反编译一下就得到了非常像计组课本上的8086汇编语言</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿Executor)-[/mnt/e/share]</span><br><span class="line">└─# ndisasm mbr.bak &gt; mbr.asm</span><br></pre></td></tr></table></figure>



<p>然后怎么分析?一共223行的汇编指令,属实高估自己的逆向能力了,与其摸着石头过河,不如先了解MBR有什么行为,然后看反汇编去取证</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/bc74f5d963f0419aa3ae51d08950272e.png" alt="MBR总览"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line">00000000  EB63              jmp short 0x65</span><br><span class="line">00000002  90                nop</span><br><span class="line">00000003  108ED0BC          adc [bp-0x4330],cl</span><br><span class="line">00000007  00B0B800          add [bx+si+0xb8],dh</span><br><span class="line">0000000B  008ED88E          add [bp-0x7128],cl</span><br><span class="line">0000000F  C0FBBE            sar bl,byte 0xbe</span><br><span class="line">00000012  007CBF            add [si-0x41],bh</span><br><span class="line">00000015  0006B900          add [0xb9],al</span><br><span class="line">00000019  02F3              add dh,bl</span><br><span class="line">0000001B  A4                movsb</span><br><span class="line">0000001C  EA21060000        jmp 0x0:0x621</span><br><span class="line">00000021  BEBE07            mov si,0x7be</span><br><span class="line">00000024  3804              cmp [si],al</span><br><span class="line">00000026  750B              jnz 0x33</span><br><span class="line">00000028  83C610            add si,byte +0x10</span><br><span class="line">0000002B  81FEFE07          cmp si,0x7fe</span><br><span class="line">0000002F  75F3              jnz 0x24</span><br><span class="line">00000031  EB16              jmp short 0x49</span><br><span class="line">00000033  B402              mov ah,0x2</span><br><span class="line">00000035  B001              mov al,0x1</span><br><span class="line">00000037  BB007C            mov bx,0x7c00</span><br><span class="line">0000003A  B280              mov dl,0x80</span><br><span class="line">0000003C  8A7401            mov dh,[si+0x1]</span><br><span class="line">0000003F  8B4C02            mov cx,[si+0x2]</span><br><span class="line">00000042  CD13              int 0x13</span><br><span class="line">00000044  EA007C0000        jmp 0x0:0x7c00</span><br><span class="line">00000049  EBFE              jmp short 0x49</span><br><span class="line">0000004B  0000              add [bx+si],al</span><br><span class="line">0000004D  0000              add [bx+si],al</span><br><span class="line">0000004F  0000              add [bx+si],al</span><br><span class="line">00000051  0000              add [bx+si],al</span><br><span class="line">00000053  0000              add [bx+si],al</span><br><span class="line">00000055  0000              add [bx+si],al</span><br><span class="line">00000057  0000              add [bx+si],al</span><br><span class="line">00000059  0000              add [bx+si],al</span><br><span class="line">0000005B  800100            add byte [bx+di],0x0</span><br><span class="line">0000005E  0000              add [bx+si],al</span><br><span class="line">00000060  0000              add [bx+si],al</span><br><span class="line">00000062  0000              add [bx+si],al</span><br><span class="line">00000064  FF                db 0xff</span><br><span class="line">00000065  FA                cli</span><br><span class="line">00000066  90                nop</span><br><span class="line">00000067  90                nop</span><br><span class="line">00000068  F6C280            test dl,0x80</span><br><span class="line">0000006B  7502              jnz 0x6f</span><br><span class="line">0000006D  B280              mov dl,0x80</span><br><span class="line">0000006F  EA747C0000        jmp 0x0:0x7c74</span><br><span class="line">00000074  31C0              xor ax,ax</span><br><span class="line">00000076  8ED8              mov ds,ax</span><br><span class="line">00000078  8ED0              mov ss,ax</span><br><span class="line">0000007A  BC0020            mov sp,0x2000</span><br><span class="line">0000007D  FB                sti</span><br><span class="line">0000007E  A0647C            mov al,[0x7c64]</span><br><span class="line">00000081  3CFF              cmp al,0xff</span><br><span class="line">00000083  7402              jz 0x87</span><br><span class="line">00000085  88C2              mov dl,al</span><br><span class="line">00000087  52                push dx</span><br><span class="line">00000088  BB1704            mov bx,0x417</span><br><span class="line">0000008B  802703            and byte [bx],0x3</span><br><span class="line">0000008E  7406              jz 0x96</span><br><span class="line">00000090  BE887D            mov si,0x7d88</span><br><span class="line">00000093  E81C01            call 0x1b2</span><br><span class="line">00000096  BE057C            mov si,0x7c05</span><br><span class="line">00000099  F6C280            test dl,0x80</span><br><span class="line">0000009C  7448              jz 0xe6</span><br><span class="line">0000009E  B441              mov ah,0x41</span><br><span class="line">000000A0  BBAA55            mov bx,0x55aa</span><br><span class="line">000000A3  CD13              int 0x13</span><br><span class="line">000000A5  5A                pop dx</span><br><span class="line">000000A6  52                push dx</span><br><span class="line">000000A7  723D              jc 0xe6</span><br><span class="line">000000A9  81FB55AA          cmp bx,0xaa55</span><br><span class="line">000000AD  7537              jnz 0xe6</span><br><span class="line">000000AF  83E101            and cx,byte +0x1</span><br><span class="line">000000B2  7432              jz 0xe6</span><br><span class="line">000000B4  31C0              xor ax,ax</span><br><span class="line">000000B6  894404            mov [si+0x4],ax</span><br><span class="line">000000B9  40                inc ax</span><br><span class="line">000000BA  8844FF            mov [si-0x1],al</span><br><span class="line">000000BD  894402            mov [si+0x2],ax</span><br><span class="line">000000C0  C7041000          mov word [si],0x10</span><br><span class="line">000000C4  668B1E5C7C        mov ebx,[0x7c5c]</span><br><span class="line">000000C9  66895C08          mov [si+0x8],ebx</span><br><span class="line">000000CD  668B1E607C        mov ebx,[0x7c60]</span><br><span class="line">000000D2  66895C0C          mov [si+0xc],ebx</span><br><span class="line">000000D6  C744060070        mov word [si+0x6],0x7000</span><br><span class="line">000000DB  B442              mov ah,0x42</span><br><span class="line">000000DD  CD13              int 0x13</span><br><span class="line">000000DF  7205              jc 0xe6</span><br><span class="line">000000E1  BB0070            mov bx,0x7000</span><br><span class="line">000000E4  EB76              jmp short 0x15c</span><br><span class="line">000000E6  B408              mov ah,0x8</span><br><span class="line">000000E8  CD13              int 0x13</span><br><span class="line">000000EA  730D              jnc 0xf9</span><br><span class="line">000000EC  F6C280            test dl,0x80</span><br><span class="line">000000EF  0F84D000          jz near 0x1c3</span><br><span class="line">000000F3  BE937D            mov si,0x7d93</span><br><span class="line">000000F6  E98200            jmp 0x17b</span><br><span class="line">000000F9  660FB6C6          movzx eax,dh</span><br><span class="line">000000FD  8864FF            mov [si-0x1],ah</span><br><span class="line">00000100  40                inc ax</span><br><span class="line">00000101  66894404          mov [si+0x4],eax</span><br><span class="line">00000105  0FB6D1            movzx dx,cl</span><br><span class="line">00000108  C1E202            shl dx,byte 0x2</span><br><span class="line">0000010B  88E8              mov al,ch</span><br><span class="line">0000010D  88F4              mov ah,dh</span><br><span class="line">0000010F  40                inc ax</span><br><span class="line">00000110  894408            mov [si+0x8],ax</span><br><span class="line">00000113  0FB6C2            movzx ax,dl</span><br><span class="line">00000116  C0E802            shr al,byte 0x2</span><br><span class="line">00000119  668904            mov [si],eax</span><br><span class="line">0000011C  66A1607C          mov eax,[0x7c60]</span><br><span class="line">00000120  6609C0            or eax,eax</span><br><span class="line">00000123  754E              jnz 0x173</span><br><span class="line">00000125  66A15C7C          mov eax,[0x7c5c]</span><br><span class="line">00000129  6631D2            xor edx,edx</span><br><span class="line">0000012C  66F734            div dword [si]</span><br><span class="line">0000012F  88D1              mov cl,dl</span><br><span class="line">00000131  31D2              xor dx,dx</span><br><span class="line">00000133  66F77404          div dword [si+0x4]</span><br><span class="line">00000137  3B4408            cmp ax,[si+0x8]</span><br><span class="line">0000013A  7D37              jnl 0x173</span><br><span class="line">0000013C  FEC1              inc cl</span><br><span class="line">0000013E  88C5              mov ch,al</span><br><span class="line">00000140  30C0              xor al,al</span><br><span class="line">00000142  C1E802            shr ax,byte 0x2</span><br><span class="line">00000145  08C1              or cl,al</span><br><span class="line">00000147  88D0              mov al,dl</span><br><span class="line">00000149  5A                pop dx</span><br><span class="line">0000014A  88C6              mov dh,al</span><br><span class="line">0000014C  BB0070            mov bx,0x7000</span><br><span class="line">0000014F  8EC3              mov es,bx</span><br><span class="line">00000151  31DB              xor bx,bx</span><br><span class="line">00000153  B80102            mov ax,0x201</span><br><span class="line">00000156  CD13              int 0x13</span><br><span class="line">00000158  721E              jc 0x178</span><br><span class="line">0000015A  8CC3              mov bx,es</span><br><span class="line">0000015C  60                pusha</span><br><span class="line">0000015D  1E                push ds</span><br><span class="line">0000015E  B90001            mov cx,0x100</span><br><span class="line">00000161  8EDB              mov ds,bx</span><br><span class="line">00000163  31F6              xor si,si</span><br><span class="line">00000165  BF0080            mov di,0x8000</span><br><span class="line">00000168  8EC6              mov es,si</span><br><span class="line">0000016A  FC                cld</span><br><span class="line">0000016B  F3A5              rep movsw</span><br><span class="line">0000016D  1F                pop ds</span><br><span class="line">0000016E  61                popa</span><br><span class="line">0000016F  FF265A7C          jmp [0x7c5a]</span><br><span class="line">00000173  BE8E7D            mov si,0x7d8e</span><br><span class="line">00000176  EB03              jmp short 0x17b</span><br><span class="line">00000178  BE9D7D            mov si,0x7d9d</span><br><span class="line">0000017B  E83400            call 0x1b2</span><br><span class="line">0000017E  BEA27D            mov si,0x7da2</span><br><span class="line">00000181  E82E00            call 0x1b2</span><br><span class="line">00000184  CD18              int 0x18</span><br><span class="line">00000186  EBFE              jmp short 0x186</span><br><span class="line">00000188  47                inc di</span><br><span class="line">00000189  52                push dx</span><br><span class="line">0000018A  55                push bp</span><br><span class="line">0000018B  42                inc dx</span><br><span class="line">0000018C  2000              and [bx+si],al</span><br><span class="line">0000018E  47                inc di</span><br><span class="line">0000018F  656F              gs outsw</span><br><span class="line">00000191  6D                insw</span><br><span class="line">00000192  004861            add [bx+si+0x61],cl</span><br><span class="line">00000195  7264              jc 0x1fb</span><br><span class="line">00000197  204469            and [si+0x69],al</span><br><span class="line">0000019A  736B              jnc 0x207</span><br><span class="line">0000019C  005265            add [bp+si+0x65],dl</span><br><span class="line">0000019F  61                popa</span><br><span class="line">000001A0  640020            add [fs:bx+si],ah</span><br><span class="line">000001A3  45                inc bp</span><br><span class="line">000001A4  7272              jc 0x218</span><br><span class="line">000001A6  6F                outsw</span><br><span class="line">000001A7  720D              jc 0x1b6</span><br><span class="line">000001A9  0A00              or al,[bx+si]</span><br><span class="line">000001AB  BB0100            mov bx,0x1</span><br><span class="line">000001AE  B40E              mov ah,0xe</span><br><span class="line">000001B0  CD10              int 0x10</span><br><span class="line">000001B2  AC                lodsb</span><br><span class="line">000001B3  3C00              cmp al,0x0</span><br><span class="line">000001B5  75F4              jnz 0x1ab</span><br><span class="line">000001B7  C3                ret</span><br><span class="line">000001B8  21BF0E00          and [bx+0xe],di</span><br><span class="line">000001BC  0000              add [bx+si],al</span><br><span class="line">000001BE  802021            and byte [bx+si],0x21</span><br><span class="line">000001C1  0083FEFF          add [bp+di-0x2],al</span><br><span class="line">000001C5  FF00              inc word [bx+si]</span><br><span class="line">000001C7  0800              or [bx+si],al</span><br><span class="line">000001C9  0000              add [bx+si],al</span><br><span class="line">000001CB  48                dec ax</span><br><span class="line">000001CC  6308              arpl [bx+si],cx</span><br><span class="line">000001CE  00FE              add dh,bh</span><br><span class="line">000001D0  FF                db 0xff</span><br><span class="line">000001D1  FF05              inc word [di]</span><br><span class="line">000001D3  FE                db 0xfe</span><br><span class="line">000001D4  FF                db 0xff</span><br><span class="line">000001D5  FF                db 0xff</span><br><span class="line">000001D6  FE                db 0xfe</span><br><span class="line">000001D7  57                push di</span><br><span class="line">000001D8  6308              arpl [bx+si],cx</span><br><span class="line">000001DA  02A05C00          add ah,[bx+si+0x5c]</span><br><span class="line">000001DE  0000              add [bx+si],al</span><br><span class="line">000001E0  0000              add [bx+si],al</span><br><span class="line">000001E2  0000              add [bx+si],al</span><br><span class="line">000001E4  0000              add [bx+si],al</span><br><span class="line">000001E6  0000              add [bx+si],al</span><br><span class="line">000001E8  0000              add [bx+si],al</span><br><span class="line">000001EA  0000              add [bx+si],al</span><br><span class="line">000001EC  0000              add [bx+si],al</span><br><span class="line">000001EE  0000              add [bx+si],al</span><br><span class="line">000001F0  0000              add [bx+si],al</span><br><span class="line">000001F2  0000              add [bx+si],al</span><br><span class="line">000001F4  0000              add [bx+si],al</span><br><span class="line">000001F6  0000              add [bx+si],al</span><br><span class="line">000001F8  0000              add [bx+si],al</span><br><span class="line">000001FA  0000              add [bx+si],al</span><br><span class="line">000001FC  0000              add [bx+si],al</span><br><span class="line">000001FE  55                push bp</span><br><span class="line">000001FF  AA                stosb</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<blockquote>
<p>如果使用ida反汇编分析</p>
<p>将mbr.bak改成mbr.exe之后使用ida打开,ida默认Segment bitness为32位,需要改成16位</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220613232353523.png" alt="image-20220613232353523"></p>
<p>一开始ida会把所有指令当作数据,只需要按一下c就可以变为指令</p>
<p>ida提供了交叉引用跳转提示和注释,他真的,我哭死</p>
</blockquote>
<p>以下反汇编分析过程参考了</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/lijiewen2017/article/details/124574991">MBR引导程序源码理解</a></p>
<p>和鸟哥的Linux私房菜第19章</p>
<p>首先记住,BIOS将MBR中的Grub加载到主存的0x7c00处,段寄存器cs存放的是0x7c00</p>
<h4 id="00000000-EB63-jmp-short-0x65"><a href="#00000000-EB63-jmp-short-0x65" class="headerlink" title="00000000  EB63        jmp short 0x65"></a><code>00000000  EB63        jmp short 0x65</code></h4><blockquote>
<p>第一条指令,可以看出其反汇编的格式为</p>
<p>内存偏移量,机器码,汇编指令</p>
</blockquote>
<blockquote>
<p>关于8086内存寻址的实现:</p>
<p>段寄存器对内存分段实现,8086上的跳转指令有段跳转和跨段跳转两种</p>
<p>CPU当前执行的指令是由<code>CS:IP</code>两个寄存器共同决定的,物理地址&#x3D;段寄存器*16+偏移地址,<br>$$<br>Addr&#x3D;CS\times 16+IP<br>$$<br>实际上就是CS的二进制表示左移4位,十六进制表示左移一位,然后加上IP</p>
<p>如果CS保持不变则为段内跳转,如果CS改变就是跨段跳转了</p>
<p>段内跳转:<code>jmp short artx</code></p>
<p>artx就是要跳转到的<strong>绝对地址</strong></p>
<p>artx是计算得到的,怎么算的呢?</p>
<p>在执行本条指令的时候,IP已经指向下一条指令的地址,</p>
<p>在实际的机器码指令中保存的是相对偏移量DISP,用这个相对偏移量加上更新了的IP得到的就是要跳转到的绝对地址</p>
<p>short表示为一个8位带符号数(范围$[-128,127]$),意思是限制相对偏移量DISP的范围</p>
</blockquote>
<p>在执行本条指令<code>00000000  EB63        jmp short 0x65</code>时,<code>IP=0x2</code>,</p>
<p>机器码<code>EB63</code>告诉我们相对偏移量<code>DISP=0x63</code>,</p>
<p><code>IP=IP+DISP=0x2+0x63=0x65</code></p>
<blockquote>
<p>至于为什么上来就要跳转到中间,越过好多字节,这个问题在<code>00000096  BE057C       mov si,0x7c05</code>我们会恍然大悟,现在看来是越过了好多”指令”没有执行,实际上不是”指令”,是反汇编器将数据也反汇编成指令了</p>
</blockquote>
<p>由于该跳转无条件执行,我们跟随该跳转,看看发生了什么</p>
<h4 id="00000065-FA-cli"><a href="#00000065-FA-cli" class="headerlink" title="00000065  FA         cli"></a><code>00000065  FA         cli</code></h4><blockquote>
<p>关于处理器控制指令</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614112455326.png" alt="image-20220614112455326"></p>
</blockquote>
<p>CLI之后,IF置0,CPU不允许中断</p>
<blockquote>
<p>信号量的机制应该也是这样</p>
</blockquote>
<p>此处的CLI指令和后面<code>0000007D  FB         sti</code>相互匹配</p>
<p>进行了一个CPU的中断关开</p>
<h4 id="00000066-90-nop"><a href="#00000066-90-nop" class="headerlink" title="00000066  90         nop"></a><code>00000066  90         nop</code></h4><p>空操作指令 NOP 执行该指令并不产生任何结果，<strong>仅仅消耗 3 个时钟周期的时间</strong>，常用于程序的延时等。</p>
<h4 id="00000067-90-nop"><a href="#00000067-90-nop" class="headerlink" title="00000067  90         nop"></a><code>00000067  90         nop</code></h4><p>同样啥也不干,耗时</p>
<h4 id="00000068-F6C280-test-dl-0x80"><a href="#00000068-F6C280-test-dl-0x80" class="headerlink" title="00000068  F6C280       test dl,0x80"></a><code>00000068  F6C280       test dl,0x80</code></h4><p>测试一下<code>dl</code>是否为<code>0x80</code></p>
<p>如果<code>dl==0x80</code>则<code>ZF=1</code>否则<code>ZF=0</code>,设置标志位之后方便后续的条件转移等</p>
<blockquote>
<p>回顾一下grub干了啥</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> 将程序代码由<span class="number">0</span>:<span class="number">7</span>C00H移动到<span class="number">0</span>:<span class="number">0600</span>H（注，BIOS把MBR放在<span class="number">0</span>:<span class="number">7</span>C00H处）</span><br><span class="line"><span class="number">2</span> 搜索可引导分区，即<span class="number">80</span>H标志</span><br><span class="line">成功：<span class="keyword">goto</span> <span class="number">3</span></span><br><span class="line">失败：跳入ROM BASIC</span><br><span class="line">无效分区表：<span class="keyword">goto</span> <span class="number">5</span></span><br><span class="line"><span class="number">3</span> 读引导扇区</span><br><span class="line">失败：<span class="keyword">goto</span> <span class="number">5</span></span><br><span class="line">成功：<span class="keyword">goto</span> <span class="number">4</span></span><br><span class="line"><span class="number">4</span> 验证引导扇区最后是否为<span class="number">55</span>AAH</span><br><span class="line">失败：<span class="keyword">goto</span> <span class="number">5</span></span><br><span class="line">成功：<span class="keyword">goto</span> <span class="number">6</span></span><br><span class="line"><span class="number">5</span> 打印错误进入无穷循环</span><br><span class="line"><span class="number">6</span> 跳到<span class="number">0</span>:<span class="number">7</span>C00H进行下一步启动工作</span><br></pre></td></tr></table></figure>

<p>80H是可引导分区的标志</p>
</blockquote>
<p>硬盘的驱动器号从0x80开始编号,这里测试dl是不是80开头的,目的是判断是否是硬盘驱动</p>
<p>奇怪的是,在此之前的指令中并没有设置dl值的指令,因此dl此时为0,本次测试必然不通过</p>
<h4 id="0000006B-7502-jnz-0x6f"><a href="#0000006B-7502-jnz-0x6f" class="headerlink" title="0000006B  7502        jnz 0x6f"></a><code>0000006B  7502        jnz 0x6f</code></h4><blockquote>
<p>关于条件跳转指令</p>
<p>条件转移指令的目的地址必须在现行的代码段（CS）内，并且以 当前指令指针寄存器 IP 内容为基准，转移范围内在＋127～－128 的范围之内。</p>
</blockquote>
<p>如果刚才判断的dl是<code>0x80</code>则跳转<code>0x6f</code>,</p>
<p>我们按照某些工作都没做,dl还没有被置为0x80,暂且不跟随跳转,顺序执行</p>
<h4 id="0000006D-B280-mov-dl-0x80"><a href="#0000006D-B280-mov-dl-0x80" class="headerlink" title="0000006D  B280              mov dl,0x80"></a><code>0000006D  B280              mov dl,0x80</code></h4><p>说曹操,曹操到,现在将dl置为0x80标志某些工作已经进行了</p>
<h4 id="0000006F-EA747C0000-jmp-0x0-0x7c74"><a href="#0000006F-EA747C0000-jmp-0x0-0x7c74" class="headerlink" title="0000006F  EA747C0000     jmp 0x0:0x7c74"></a><code>0000006F  EA747C0000     jmp 0x0:0x7c74</code></h4><p>绝对跳转,跳转到<code>0x7c74</code>,也就是<code>0x74</code>位置,笑死,就在下一行</p>
<h4 id="00000074-31C0-xor-ax-ax"><a href="#00000074-31C0-xor-ax-ax" class="headerlink" title="00000074  31C0        xor ax,ax"></a><code>00000074  31C0        xor ax,ax</code></h4><p>ax寄存器置零,没有用<code>mov ax,0</code>是因为mov指令编码长,用xor指令优化</p>
<h4 id="00000076-8ED8-mov-ds-ax"><a href="#00000076-8ED8-mov-ds-ax" class="headerlink" title="00000076  8ED8        mov ds,ax"></a><code>00000076  8ED8        mov ds,ax</code></h4><p><code>0-&gt;ax-&gt;ds</code></p>
<p>ds段寄存器置0,</p>
<h4 id="00000078-8ED0-mov-ss-ax"><a href="#00000078-8ED0-mov-ss-ax" class="headerlink" title="00000078  8ED0        mov ss,ax"></a><code>00000078  8ED0        mov ss,ax</code></h4><p>ss寄存器置0</p>
<blockquote>
<p>ss为stack segment,堆栈段寄存器,栈顶指针的段地址在ss寄存器中,段内偏移量在sp中,ss:sp指向栈顶</p>
</blockquote>
<h4 id="0000007A-BC0020-mov-sp-0x2000"><a href="#0000007A-BC0020-mov-sp-0x2000" class="headerlink" title="0000007A  BC0020       mov sp,0x2000"></a><code>0000007A  BC0020       mov sp,0x2000</code></h4><p>本步和上一步正式建立了栈空间</p>
<h4 id="0000007D-FB-sti"><a href="#0000007D-FB-sti" class="headerlink" title="0000007D  FB         sti"></a><code>0000007D  FB         sti</code></h4><blockquote>
<p>关于处理器控制指令</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614111629831.png" alt="image-20220614111629831"></p>
</blockquote>
<p>标志位指令,STI是开中断标志,该指令执行之后IF&#x3D;1,意思是允许CPU发生中断了,</p>
<p>本指令和<code>00000065  FA         cli</code>之间的指令会被CPU一直执行不被中断,这保证了各种寄存器和堆栈等一直有效</p>
<h4 id="0000007E-A0647C-mov-al-0x7c64"><a href="#0000007E-A0647C-mov-al-0x7c64" class="headerlink" title="0000007E  A0647C       mov al,[0x7c64]"></a><code>0000007E  A0647C       mov al,[0x7c64]</code></h4><p>一个直接寻址,将内存上<code>0x7c64</code>这个单元中的东西放在<code>al</code>寄存器中</p>
<p><code>0x7c64</code>所指位置代表启动盘,内核存放其中</p>
<p>这个单元放了啥呢?	<code>00000064  FF         db 0xff</code></p>
<p><code>0xff</code>表示使用启动盘</p>
<h4 id="00000081-3CFF-cmp-al-0xff"><a href="#00000081-3CFF-cmp-al-0xff" class="headerlink" title="00000081  3CFF        cmp al,0xff"></a><code>00000081  3CFF        cmp al,0xff</code></h4><p>蜜汁操作,刚刚把<code>M[0x7c64]=0xff</code>放进al,就要检查al是不是<code>0xff</code></p>
<p>猜测是后来<code>M[0x7c64]</code>会有改变,现在是第一次执行,尚且没变</p>
<p>这应该是一个指针</p>
<h4 id="00000083-7402-jz-0x87"><a href="#00000083-7402-jz-0x87" class="headerlink" title="00000083  7402        jz 0x87"></a><code>00000083  7402        jz 0x87</code></h4><p>如果刚才的检查通过,则跳转<code>0x87</code></p>
<p>由于<code>0x87</code>和<code>0x83</code>之间(即刚才的检查没通过时),只有一条指令,我们不跟随跳转</p>
<blockquote>
<p>这里检查我们是否有强制磁盘引用</p>
</blockquote>
<h4 id="00000085-88C2-mov-dl-al"><a href="#00000085-88C2-mov-dl-al" class="headerlink" title="00000085  88C2        mov dl,al"></a><code>00000085  88C2        mov dl,al</code></h4><p><code>0x81</code>处的检查没有通过,即<code>al</code>中不是<code>0xff</code>,是多少现在不知道,先放在<code>dl</code>中</p>
<p>在此之前涉及到<code>dl</code>寄存器的有一个<code>0000006D  B280              mov dl,0x80</code></p>
<p>dl置0x80是可引导分区的标志,现在把他改了,推测为后面引导失败埋下伏笔</p>
<p>首次执行,本条指令不会被执行</p>
<h4 id="00000087-52-push-dx"><a href="#00000087-52-push-dx" class="headerlink" title="00000087  52         push dx"></a><code>00000087  52         push dx</code></h4><p>dx寄存器中的东西压栈</p>
<p>dx中是啥呢?dh高位啃腚为0,低位有两种情况</p>
<p>如果<code>00000081  3CFF        cmp al,0xff</code>处的判断通过,则<code>dl=0x80</code></p>
<p>否则就不是第一次执行到这里了,<code>M[0x7c64]</code>已经发生过改变</p>
<p>我们按照第一次执行的逻辑,dx就是0xff</p>
<blockquote>
<p>此时栈中状态</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614160219999.png" alt="image-20220614160219999"></p>
</blockquote>
<h4 id="00000088-BB1704-mov-bx-0x417"><a href="#00000088-BB1704-mov-bx-0x417" class="headerlink" title="00000088  BB1704       mov bx,0x417"></a><code>00000088  BB1704       mov bx,0x417</code></h4><p><code>0x417-&gt;bx</code></p>
<h4 id="0000008B-802703-and-byte-bx-0x3"><a href="#0000008B-802703-and-byte-bx-0x3" class="headerlink" title="0000008B  802703       and byte [bx],0x3"></a><code>0000008B  802703       and byte [bx],0x3</code></h4><blockquote>
<p>关于属性运算符</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614114636880.png" alt="image-20220614114636880"></p>
</blockquote>
<p>bx在上一条指令中已经置为<code>0x417</code>了</p>
<p>本条指令的意思是,首先进行一个寄存器间接寻址,取<code>M[R[bx]]=M[0x417]</code></p>
<p>取出该内存单元的最低字节的内容,看看最低位是不是两个1,如果是则置标志位<code>ZF=1</code></p>
<h4 id="0000008E-7406-jz-0x96"><a href="#0000008E-7406-jz-0x96" class="headerlink" title="0000008E  7406        jz 0x96"></a><code>0000008E  7406        jz 0x96</code></h4><p>如果刚才的判断通过,则跳转<code>0x96</code></p>
<p>跳转越过了<code>0x90,0x93</code>两条指令,这是一个函数调用</p>
<h4 id="00000090-BE887D-mov-si-0x7d88"><a href="#00000090-BE887D-mov-si-0x7d88" class="headerlink" title="00000090  BE887D       mov si,0x7d88"></a><code>00000090  BE887D       mov si,0x7d88</code></h4><p>把<code>0x7d88</code>放在si寄存器,作为串操作的源头</p>
<p>而<code>0x7d88</code>上放的是啥呢?</p>
<p><code>0x7d88</code>相对于本文件基地址的偏移量为<code>0x7d88-0x7c00=0x188</code></p>
<p>去这个地方看一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">00000188  47                inc di</span><br><span class="line">00000189  52                push dx</span><br><span class="line">0000018A  55                push bp</span><br><span class="line">0000018B  42                inc dx</span><br></pre></td></tr></table></figure>

<p>都是指令?这就奇怪了,串操作的源头是一些指令,而不是一个连续的数组.</p>
<p>目前我们只是看出了串操作的一点雏形,将”源”放在si寄存器中,但是用串操作干了什么,尚不可知,</p>
<p>我们暂且保持懵逼的状态,继续向后看,我保证后面有一刻,会恍然大悟</p>
<h4 id="00000093-E81C01-call-0x1b2"><a href="#00000093-E81C01-call-0x1b2" class="headerlink" title="00000093  E81C01       call 0x1b2"></a><code>00000093  E81C01       call 0x1b2</code></h4><p>调用位于<code>0x1b2</code>的函数</p>
<p>我们跟随该函数</p>
<h4 id="进入循环"><a href="#进入循环" class="headerlink" title="进入循环"></a>进入循环</h4><blockquote>
<p>该调用指令,实际上进入了一个循环,但是现在看不出来</p>
</blockquote>
<h4 id="000001B2-AC-lodsb"><a href="#000001B2-AC-lodsb" class="headerlink" title="000001B2  AC         lodsb"></a><code>000001B2  AC         lodsb</code></h4><blockquote>
<p>关于串装入指令</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614151353806.png" alt="image-20220614151353806"></p>
<p>说了个什么事情呢?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov al, ［esi］    ;将字节送入AL</span><br><span class="line">inc esi    ;指向下一个字节</span><br></pre></td></tr></table></figure>
</blockquote>
<p>在调用函数之前,<code>si&lt;-0x7d88</code></p>
<p><code>mov al, ［esi］</code>执行之后,<code>M[0x7d88]=M[0x188]-&gt;al</code></p>
<p><code>inc esi    ;</code>执行之后,<code>0x7d89-&gt;si</code></p>
<h4 id="000001B3-3C00-cmp-al-0x0"><a href="#000001B3-3C00-cmp-al-0x0" class="headerlink" title="000001B3  3C00        cmp al,0x0"></a><code>000001B3  3C00        cmp al,0x0</code></h4><p>比较al是不是0</p>
<h4 id="000001B5-75F4-jnz-0x1ab"><a href="#000001B5-75F4-jnz-0x1ab" class="headerlink" title="000001B5  75F4        jnz 0x1ab"></a><code>000001B5  75F4        jnz 0x1ab</code></h4><p>如果al不是0则跳转<code>0x1ab</code></p>
<h4 id="000001AB-BB0100-mov-bx-0x1"><a href="#000001AB-BB0100-mov-bx-0x1" class="headerlink" title="000001AB  BB0100       mov bx,0x1"></a><code>000001AB  BB0100       mov bx,0x1</code></h4><p><code>1-&gt;bx</code>,给后面的int指令设置参数</p>
<h4 id="000001AE-B40E-mov-ah-0xe"><a href="#000001AE-B40E-mov-ah-0xe" class="headerlink" title="000001AE  B40E        mov ah,0xe"></a><code>000001AE  B40E        mov ah,0xe</code></h4><p><code>0xe-&gt;ah</code>,给后面的int指令设置参数</p>
<h4 id="000001B0-CD10-int-0x10"><a href="#000001B0-CD10-int-0x10" class="headerlink" title="000001B0  CD10        int 0x10"></a><code>000001B0  CD10        int 0x10</code></h4><blockquote>
<p>此处的中断参考<a target="_blank" rel="noopener" href="https://zoxoy.club/post/Print-char-by-INT-0x10/">使用汇编语言触发BIOS中断INT 0x10进行屏幕输出 (zoxoy.club)</a></p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614152209611.png" alt="image-20220614152209611"></p>
</blockquote>
<p>在<code>0x1AE</code>中ah已经被置为<code>0xe</code>,那么此中断就触发了屏幕输出,输出的是啥呢?</p>
<p>要显示的字符在AL上</p>
<p>可以看出来,从<code>0x1AB</code>到<code>0x1B5</code>是一个循环,循环打印字符到屏幕,循环停止的条件是碰见<code>\0</code>结束标志</p>
<p>字符来源是<code>0x1B2</code>的<code>lodsb</code>,是从<code>0x93</code>处的调用指令<code>00000093  E81C01       call 0x1b2</code>转移过来的</p>
<p><code>lodsb</code>操作串的来源是<code>00000090  BE887D       mov si,0x7d88</code>,即内存中<code>0x7d88</code>这个位置</p>
<p>现在我们必须要考虑清楚串操作的源头为啥是一伙子指令了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">00000188  47                inc di</span><br><span class="line">00000189  52                push dx</span><br><span class="line">0000018A  55                push bp</span><br><span class="line">0000018B  42                inc dx</span><br><span class="line">0000018C  2000              and [bx+si],al</span><br></pre></td></tr></table></figure>

<p>观察机器码,<code>0x47,0x52,0x55,0x42,0x00,0x20</code>(最后小端模式拆开)</p>
<p>好像前面几个都是ASCII可打印字符,尝试打印一下</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614153820258.png" alt="image-20220614153820258"></p>
<p>竟然打印出了”GRUB”字样,这绝对不是巧合,就应该是这个字符串</p>
<p><strong>原来是nasm软件无法区分指令和数据,将数据也反汇编成指令了</strong></p>
<p>那么<code>0x188到0x18c</code>对应<code>G,R,U,B,\0</code></p>
<p><code>0x18d</code>上放了一个20不应该和<code>0x18c</code>合起来分析</p>
<p>这意味着后面的反汇编很可能都是错误的,暂且不管后面的错误,我们刚才调用函数打印grub字符串的逻辑是没有错误的</p>
<p>在一开始我们使用010editor观察时,</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614160458438.png" alt="image-20220614160458438"></p>
<p>后面还有好多具有实际意义的字符串</p>
<p>Error的ASCII编码为<code>0x45 72 72 6f 72</code></p>
<p>确实后面的”指令”中,有这个字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">000001A3  45                inc bp</span><br><span class="line">000001A4  7272              jc 0x218</span><br><span class="line">000001A6  6F                outsw</span><br><span class="line">000001A7  720D              jc 0x1b6</span><br></pre></td></tr></table></figure>

<p>由此可见这一大块都是字符串</p>
<h4 id="退出循环"><a href="#退出循环" class="headerlink" title="退出循环"></a>退出循环</h4><p>实际上”循环”就是指循环打印<code>0x188</code>上存好的<code>grub</code>字符串</p>
<p>跳出循环的条件是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">000001B2  AC                lodsb</span><br><span class="line">000001B3  3C00              cmp al,0x0</span><br><span class="line">000001B5  75F4              jnz 0x1ab</span><br></pre></td></tr></table></figure>

<p>这里al为0,即指向<code>grub\0</code>最后这个<code>\0</code></p>
<p>跳出循环即执行<code>000001B7  C3         ret</code></p>
<h4 id="000001B7-C3-ret"><a href="#000001B7-C3-ret" class="headerlink" title="000001B7  C3         ret"></a><code>000001B7  C3         ret</code></h4><p>函数调用返回,返回到<code>00000093  E81C01       call 0x1b2</code>的下一句<code>00000096  BE057C       mov si,0x7c05</code></p>
<h4 id="00000096-BE057C-mov-si-0x7c05"><a href="#00000096-BE057C-mov-si-0x7c05" class="headerlink" title="00000096  BE057C       mov si,0x7c05"></a><code>00000096  BE057C       mov si,0x7c05</code></h4><p><code>0x7c05</code>作为串的源头,<code>0x7c05</code>上是什么呢?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">00000003  108ED0BC          adc [bp-0x4330],cl</span><br><span class="line">00000007  00B0B800          add [bx+si+0xb8],dh</span><br></pre></td></tr></table></figure>

<p><code>M[0x3]=BC</code></p>
<p><code>M[0x4]=D0</code></p>
<p><code>M[0x5]=8E</code></p>
<p><code>M[0x6]=10</code></p>
<p><code>M[0x7]=00</code></p>
<h4 id="00000099-F6C280-test-dl-0x80"><a href="#00000099-F6C280-test-dl-0x80" class="headerlink" title="00000099  F6C280       test dl,0x80"></a><code>00000099  F6C280       test dl,0x80</code></h4><p>检查dl上是否还是0x80</p>
<h4 id="0000009C-7448-jz-0xe6"><a href="#0000009C-7448-jz-0xe6" class="headerlink" title="0000009C  7448        jz 0xe6"></a><code>0000009C  7448        jz 0xe6</code></h4><p>如果dl上是0x80则跳转0xe6,如果不是则继续执行</p>
<p>不跟随跳转,继续执行</p>
<h4 id="0000009E-B441-mov-ah-0x41"><a href="#0000009E-B441-mov-ah-0x41" class="headerlink" title="0000009E  B441        mov ah,0x41"></a><code>0000009E  B441        mov ah,0x41</code></h4><p>ah高位置0x41,是为了给<code>int 0x13</code>指令设置参数</p>
<h4 id="000000A0-BBAA55-mov-bx-0x55aa"><a href="#000000A0-BBAA55-mov-bx-0x55aa" class="headerlink" title="000000A0  BBAA55       mov bx,0x55aa"></a><code>000000A0  BBAA55       mov bx,0x55aa</code></h4><p><code>0x55aa-&gt;bx</code>,<code>0x55aa</code>是主引导记录的魔数,这里应该是要进行某些判断了</p>
<h4 id="000000A3-CD13-int-0x13"><a href="#000000A3-CD13-int-0x13" class="headerlink" title="000000A3  CD13        int 0x13"></a><code>000000A3  CD13        int 0x13</code></h4><blockquote>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614161620001.png" alt="image-20220614161620001"></p>
</blockquote>
<h4 id="000000A5-5A-pop-dx"><a href="#000000A5-5A-pop-dx" class="headerlink" title="000000A5  5A         pop dx"></a><code>000000A5  5A         pop dx</code></h4><p>恢复<code>dx=0x80</code></p>
<h4 id="000000A6-52-push-dx"><a href="#000000A6-52-push-dx" class="headerlink" title="000000A6  52         push dx"></a><code>000000A6  52         push dx</code></h4><p><code>0x80</code>压栈</p>
<p>这两步显得很迷,退出来又放进去</p>
<blockquote>
<p>%dl 可能已被 INT 13 破坏，AH&#x3D;41H。 例如，在 AST BIOS 1.04 中会发生这种情况。所以通过重复出入栈来纠正。</p>
</blockquote>
<h4 id="000000A7-723D-jc-0xe6"><a href="#000000A7-723D-jc-0xe6" class="headerlink" title="000000A7  723D        jc 0xe6"></a><code>000000A7  723D        jc 0xe6</code></h4><p>如果标志位CF&#x3D;1则跳转</p>
<p>哪里置的标志位呢?</p>
<blockquote>
<p>jc指令与上面的int 13H ah&#x3D;41H中断例程形成配合。后者的作用是判断 BIOS 是否支持扩展int13中断，如果支持，则CF&#x3D;0，否则CF&#x3D;1，那么jc指令就可以根据 BIOS 是否支持扩展int13中断来执行不同位置的“子程序指令”。</p>
<p>一般现在新的支持LBA模式的主板和Win98自带的DOS7操作系统是支持扩展INT 13的。</p>
</blockquote>
<h4 id="000000A9-81FB55AA-cmp-bx-0xaa55"><a href="#000000A9-81FB55AA-cmp-bx-0xaa55" class="headerlink" title="000000A9  81FB55AA      cmp bx,0xaa55"></a><code>000000A9  81FB55AA      cmp bx,0xaa55</code></h4><p>显然之前bx置过0xaa55,此处零标志置1</p>
<h4 id="000000AD-7537-jnz-0xe6"><a href="#000000AD-7537-jnz-0xe6" class="headerlink" title="000000AD  7537        jnz 0xe6"></a><code>000000AD  7537        jnz 0xe6</code></h4><blockquote>
<p>此时标志位ZF不等于0，所以jnz 0xd8不进行跳转。</p>
<p>谨慎起见，这条指令和上一条指令配合使用，继jc 0xd8之后，再次对int 13H ah&#x3D;41H中断指令的结果进行确认。确认BIOS支持扩展int13。</p>
<p>0xd8 处的指令是 CHS 寻址模式的，即是说如果不支持 LBA 寻址模式，则使用 CHS。</p>
</blockquote>
<h4 id="000000AF-83E101-and-cx-byte-0x1"><a href="#000000AF-83E101-and-cx-byte-0x1" class="headerlink" title="000000AF  83E101       and cx,byte +0x1"></a><code>000000AF  83E101       and cx,byte +0x1</code></h4><blockquote>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614162458403.png" alt="image-20220614162458403"></p>
</blockquote>
<h4 id="000000B2-7432-jz-0xe6"><a href="#000000B2-7432-jz-0xe6" class="headerlink" title="000000B2  7432        jz 0xe6"></a><code>000000B2  7432        jz 0xe6</code></h4><p>不跳转</p>
<h4 id="000000B4-31C0-xor-ax-ax"><a href="#000000B4-31C0-xor-ax-ax" class="headerlink" title="000000B4  31C0        xor ax,ax"></a><code>000000B4  31C0        xor ax,ax</code></h4><p>ax寄存器置0</p>
<h4 id="000000B6-894404-mov-si-0x4-ax"><a href="#000000B6-894404-mov-si-0x4-ax" class="headerlink" title="000000B6  894404       mov [si+0x4],ax"></a><code>000000B6  894404       mov [si+0x4],ax</code></h4><p>此前si寄存器被置为0x7c05,现在将0放到0x7c09,0x7c0A上</p>
<blockquote>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614162653873.png" alt="image-20220614162653873"></p>
</blockquote>
<h4 id="000000B9-40-inc-ax"><a href="#000000B9-40-inc-ax" class="headerlink" title="000000B9  40         inc ax"></a><code>000000B9  40         inc ax</code></h4><p>ax&#x3D;0x1</p>
<h4 id="000000BA-8844FF-mov-si-0x1-al"><a href="#000000BA-8844FF-mov-si-0x1-al" class="headerlink" title="000000BA  8844FF       mov [si-0x1],al"></a><code>000000BA  8844FF       mov [si-0x1],al</code></h4><p>si-0x1指向0x7c04,将al的第字节0x1放进去</p>
<blockquote>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614162805804.png" alt="image-20220614162805804"></p>
</blockquote>
<h4 id="000000BD-894402-mov-si-0x2-ax"><a href="#000000BD-894402-mov-si-0x2-ax" class="headerlink" title="000000BD  894402       mov [si+0x2],ax"></a><code>000000BD  894402       mov [si+0x2],ax</code></h4><p>1放到0x7c07</p>
<blockquote>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614162856400.png" alt="image-20220614162856400"></p>
</blockquote>
<h4 id="000000C0-C7041000-mov-word-si-0x10"><a href="#000000C0-C7041000-mov-word-si-0x10" class="headerlink" title="000000C0  C7041000      mov word [si],0x10"></a><code>000000C0  C7041000      mov word [si],0x10</code></h4><p>0x10看成一个双字(高八位全0)放到0x7c05,0x7c06</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614162933671.png" alt="image-20220614162933671"></p>
<p>0x7c06应该为0</p>
<blockquote>
<p>为啥这里要用一个”WORD”,前面都没用?</p>
<p>因为这里直接把一个立即数放到内存上,没有经过寄存器,将寄存器搬到内存时,寄存器规格决定占用内存上几个单元</p>
<p>现在立即数0x10可以作为一个字节,可以作为一个字,一个双字等等,要用word规定一下0x10作为什么传送</p>
</blockquote>
<p>我太难了, 这暗无天日的反汇编分析什么时候是个头啊,不分析了放一个大佬的博客吧</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/lijiewen2017/article/details/124574991"> MBR引导程序源码理解_背风衣人的博客-CSDN博客_mbr启动代码</a></p>
<h2 id="Kernel"><a href="#Kernel" class="headerlink" title="Kernel"></a>Kernel</h2><p>不管Grub干了啥,总之,它最后加载了Kernel并把控制交给了Kernel</p>
<p>从哪里加载的kernel呢?在硬盘中,文件系统的<code>/boot/</code>下面,vmlinuz文件,比如</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614165129321.png" alt="image-20220614165129321"></p>
<p>问题是,现在的SATA硬盘驱动都是以模块方式添加的设备,在操作系统启起来之前,必然不可能载入模块</p>
<p>这个问题是用Initial RamDisk技术解决的</p>
<p><img src="https://raw.githubusercontent.com/DeutschBall/test/master/image-20220614235435725.png" alt="image-20220614235435725"></p>
<p>台湾人把它翻译成”虚拟文件系统”,实际上和VFS不是一个东西</p>
<p>到此,操作系统就起来了,后面操作系统(kernel)会检查各种硬件,然后启动各种服务</p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>dustball
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="http://deutschball.github.io/2022/06/15/%E8%B5%B7%E6%9D%A5,%E4%B8%8D%E6%84%BF%E5%81%9A%E6%9D%BF%E7%A0%96%E5%84%BF%E7%9A%84%E8%AE%A1%E7%AE%97%E6%9C%BA/" title="起来,不愿作板儿砖的计算机">http://deutschball.github.io/2022/06/15/起来,不愿做板砖儿的计算机/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/linux/" rel="tag"># linux</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/06/12/%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98/" rel="prev" title="CSAPP-chapter9 内存管理">
      <i class="fa fa-chevron-left"></i> CSAPP-chapter9 内存管理
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/06/17/%E6%9C%BA%E5%99%A8%E7%BA%A7%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%9A%84%E5%8E%9F%E7%90%86/" rel="next" title="机器级算术运算的原理">
      机器级算术运算的原理 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%B5%B7%E6%9D%A5-%E4%B8%8D%E6%84%BF%E4%BD%9C%E6%9D%BF%E5%84%BF%E7%A0%96%E7%9A%84%E8%AE%A1%E7%AE%97%E6%9C%BA"><span class="nav-number">1.</span> <span class="nav-text">起来,不愿作板儿砖的计算机</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#BIOS"><span class="nav-number">1.1.</span> <span class="nav-text">BIOS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#BIOS%E5%81%9A%E7%9A%84%E4%BA%8B%E6%83%85"><span class="nav-number">1.1.1.</span> <span class="nav-text">BIOS做的事情</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BIOS%E8%AE%BE%E7%BD%AE"><span class="nav-number">1.1.2.</span> <span class="nav-text">BIOS设置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Main%E8%A7%86%E5%9B%BE"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">Main视图</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Legacy-Diskette"><span class="nav-number">1.1.2.1.1.</span> <span class="nav-text">Legacy Diskette</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Primary-Second-Master-Slave"><span class="nav-number">1.1.2.1.2.</span> <span class="nav-text">Primary&#x2F;Second Master&#x2F;Slave</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Keyboard-Features"><span class="nav-number">1.1.2.1.3.</span> <span class="nav-text">Keyboard Features</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Memory"><span class="nav-number">1.1.2.1.4.</span> <span class="nav-text">Memory</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Boot-time-Diagnositc-Screen"><span class="nav-number">1.1.2.1.5.</span> <span class="nav-text">Boot-time Diagnositc Screen</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Advanced%E8%A7%86%E5%9B%BE"><span class="nav-number">1.1.2.2.</span> <span class="nav-text">Advanced视图</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Multiprocessor-Specification"><span class="nav-number">1.1.2.2.1.</span> <span class="nav-text">Multiprocessor Specification</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Installed-O-S"><span class="nav-number">1.1.2.2.2.</span> <span class="nav-text">Installed O&#x2F;S</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Reset-Configuration-Data"><span class="nav-number">1.1.2.2.3.</span> <span class="nav-text">Reset Configuration Data:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Cache-Memory"><span class="nav-number">1.1.2.2.4.</span> <span class="nav-text">Cache Memory</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#I-O-Device-Configuration"><span class="nav-number">1.1.2.2.5.</span> <span class="nav-text">I&#x2F;O Device Configuration</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Large-Disk-Access-Mode"><span class="nav-number">1.1.2.2.6.</span> <span class="nav-text">Large Disk Access Mode</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Local-Bus-IDE-adapter"><span class="nav-number">1.1.2.2.7.</span> <span class="nav-text">Local Bus IDE adapter</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Advanced-Chipset-Control"><span class="nav-number">1.1.2.2.8.</span> <span class="nav-text">Advanced Chipset Control</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Security%E8%A7%86%E5%9B%BE"><span class="nav-number">1.1.2.3.</span> <span class="nav-text">Security视图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Boot"><span class="nav-number">1.1.2.4.</span> <span class="nav-text">Boot</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BB%E5%BC%95%E5%AF%BC%E8%AE%B0%E5%BD%95MBR"><span class="nav-number">1.2.</span> <span class="nav-text">主引导记录MBR</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E4%B8%8A%E7%9A%84%E4%B8%BB%E5%BC%95%E5%AF%BC%E8%AE%B0%E5%BD%95"><span class="nav-number">1.2.1.</span> <span class="nav-text">磁盘上的主引导记录</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Grub"><span class="nav-number">1.3.</span> <span class="nav-text">Grub</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%A4%E4%B8%AA%E9%98%B6%E6%AE%B5"><span class="nav-number">1.3.1.</span> <span class="nav-text">两个阶段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8D%E6%B1%87%E7%BC%96%E5%88%86%E6%9E%90"><span class="nav-number">1.3.2.</span> <span class="nav-text">反汇编分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#00000000-EB63-jmp-short-0x65"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">00000000  EB63        jmp short 0x65</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000065-FA-cli"><span class="nav-number">1.3.2.2.</span> <span class="nav-text">00000065  FA         cli</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000066-90-nop"><span class="nav-number">1.3.2.3.</span> <span class="nav-text">00000066  90         nop</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000067-90-nop"><span class="nav-number">1.3.2.4.</span> <span class="nav-text">00000067  90         nop</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000068-F6C280-test-dl-0x80"><span class="nav-number">1.3.2.5.</span> <span class="nav-text">00000068  F6C280       test dl,0x80</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0000006B-7502-jnz-0x6f"><span class="nav-number">1.3.2.6.</span> <span class="nav-text">0000006B  7502        jnz 0x6f</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0000006D-B280-mov-dl-0x80"><span class="nav-number">1.3.2.7.</span> <span class="nav-text">0000006D  B280              mov dl,0x80</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0000006F-EA747C0000-jmp-0x0-0x7c74"><span class="nav-number">1.3.2.8.</span> <span class="nav-text">0000006F  EA747C0000     jmp 0x0:0x7c74</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000074-31C0-xor-ax-ax"><span class="nav-number">1.3.2.9.</span> <span class="nav-text">00000074  31C0        xor ax,ax</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000076-8ED8-mov-ds-ax"><span class="nav-number">1.3.2.10.</span> <span class="nav-text">00000076  8ED8        mov ds,ax</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000078-8ED0-mov-ss-ax"><span class="nav-number">1.3.2.11.</span> <span class="nav-text">00000078  8ED0        mov ss,ax</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0000007A-BC0020-mov-sp-0x2000"><span class="nav-number">1.3.2.12.</span> <span class="nav-text">0000007A  BC0020       mov sp,0x2000</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0000007D-FB-sti"><span class="nav-number">1.3.2.13.</span> <span class="nav-text">0000007D  FB         sti</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0000007E-A0647C-mov-al-0x7c64"><span class="nav-number">1.3.2.14.</span> <span class="nav-text">0000007E  A0647C       mov al,[0x7c64]</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000081-3CFF-cmp-al-0xff"><span class="nav-number">1.3.2.15.</span> <span class="nav-text">00000081  3CFF        cmp al,0xff</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000083-7402-jz-0x87"><span class="nav-number">1.3.2.16.</span> <span class="nav-text">00000083  7402        jz 0x87</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000085-88C2-mov-dl-al"><span class="nav-number">1.3.2.17.</span> <span class="nav-text">00000085  88C2        mov dl,al</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000087-52-push-dx"><span class="nav-number">1.3.2.18.</span> <span class="nav-text">00000087  52         push dx</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000088-BB1704-mov-bx-0x417"><span class="nav-number">1.3.2.19.</span> <span class="nav-text">00000088  BB1704       mov bx,0x417</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0000008B-802703-and-byte-bx-0x3"><span class="nav-number">1.3.2.20.</span> <span class="nav-text">0000008B  802703       and byte [bx],0x3</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0000008E-7406-jz-0x96"><span class="nav-number">1.3.2.21.</span> <span class="nav-text">0000008E  7406        jz 0x96</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000090-BE887D-mov-si-0x7d88"><span class="nav-number">1.3.2.22.</span> <span class="nav-text">00000090  BE887D       mov si,0x7d88</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000093-E81C01-call-0x1b2"><span class="nav-number">1.3.2.23.</span> <span class="nav-text">00000093  E81C01       call 0x1b2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9B%E5%85%A5%E5%BE%AA%E7%8E%AF"><span class="nav-number">1.3.2.24.</span> <span class="nav-text">进入循环</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000001B2-AC-lodsb"><span class="nav-number">1.3.2.25.</span> <span class="nav-text">000001B2  AC         lodsb</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000001B3-3C00-cmp-al-0x0"><span class="nav-number">1.3.2.26.</span> <span class="nav-text">000001B3  3C00        cmp al,0x0</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000001B5-75F4-jnz-0x1ab"><span class="nav-number">1.3.2.27.</span> <span class="nav-text">000001B5  75F4        jnz 0x1ab</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000001AB-BB0100-mov-bx-0x1"><span class="nav-number">1.3.2.28.</span> <span class="nav-text">000001AB  BB0100       mov bx,0x1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000001AE-B40E-mov-ah-0xe"><span class="nav-number">1.3.2.29.</span> <span class="nav-text">000001AE  B40E        mov ah,0xe</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000001B0-CD10-int-0x10"><span class="nav-number">1.3.2.30.</span> <span class="nav-text">000001B0  CD10        int 0x10</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%80%E5%87%BA%E5%BE%AA%E7%8E%AF"><span class="nav-number">1.3.2.31.</span> <span class="nav-text">退出循环</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000001B7-C3-ret"><span class="nav-number">1.3.2.32.</span> <span class="nav-text">000001B7  C3         ret</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000096-BE057C-mov-si-0x7c05"><span class="nav-number">1.3.2.33.</span> <span class="nav-text">00000096  BE057C       mov si,0x7c05</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#00000099-F6C280-test-dl-0x80"><span class="nav-number">1.3.2.34.</span> <span class="nav-text">00000099  F6C280       test dl,0x80</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0000009C-7448-jz-0xe6"><span class="nav-number">1.3.2.35.</span> <span class="nav-text">0000009C  7448        jz 0xe6</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0000009E-B441-mov-ah-0x41"><span class="nav-number">1.3.2.36.</span> <span class="nav-text">0000009E  B441        mov ah,0x41</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000000A0-BBAA55-mov-bx-0x55aa"><span class="nav-number">1.3.2.37.</span> <span class="nav-text">000000A0  BBAA55       mov bx,0x55aa</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000000A3-CD13-int-0x13"><span class="nav-number">1.3.2.38.</span> <span class="nav-text">000000A3  CD13        int 0x13</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000000A5-5A-pop-dx"><span class="nav-number">1.3.2.39.</span> <span class="nav-text">000000A5  5A         pop dx</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000000A6-52-push-dx"><span class="nav-number">1.3.2.40.</span> <span class="nav-text">000000A6  52         push dx</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000000A7-723D-jc-0xe6"><span class="nav-number">1.3.2.41.</span> <span class="nav-text">000000A7  723D        jc 0xe6</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000000A9-81FB55AA-cmp-bx-0xaa55"><span class="nav-number">1.3.2.42.</span> <span class="nav-text">000000A9  81FB55AA      cmp bx,0xaa55</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000000AD-7537-jnz-0xe6"><span class="nav-number">1.3.2.43.</span> <span class="nav-text">000000AD  7537        jnz 0xe6</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000000AF-83E101-and-cx-byte-0x1"><span class="nav-number">1.3.2.44.</span> <span class="nav-text">000000AF  83E101       and cx,byte +0x1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000000B2-7432-jz-0xe6"><span class="nav-number">1.3.2.45.</span> <span class="nav-text">000000B2  7432        jz 0xe6</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000000B4-31C0-xor-ax-ax"><span class="nav-number">1.3.2.46.</span> <span class="nav-text">000000B4  31C0        xor ax,ax</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000000B6-894404-mov-si-0x4-ax"><span class="nav-number">1.3.2.47.</span> <span class="nav-text">000000B6  894404       mov [si+0x4],ax</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000000B9-40-inc-ax"><span class="nav-number">1.3.2.48.</span> <span class="nav-text">000000B9  40         inc ax</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000000BA-8844FF-mov-si-0x1-al"><span class="nav-number">1.3.2.49.</span> <span class="nav-text">000000BA  8844FF       mov [si-0x1],al</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000000BD-894402-mov-si-0x2-ax"><span class="nav-number">1.3.2.50.</span> <span class="nav-text">000000BD  894402       mov [si+0x2],ax</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#000000C0-C7041000-mov-word-si-0x10"><span class="nav-number">1.3.2.51.</span> <span class="nav-text">000000C0  C7041000      mov word [si],0x10</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Kernel"><span class="nav-number">1.4.</span> <span class="nav-text">Kernel</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="dustball"
      src="https://raw.githubusercontent.com/DeutschBall/picbed/main/dustball.png">
  <p class="site-author-name" itemprop="name">dustball</p>
  <div class="site-description" itemprop="description">dustland</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">dustball</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  
  <script data-pjax>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="//cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script>
<script src="/js/algolia-search.js"></script>












<script data-pjax>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'dark',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


    <div id="pjax">
  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

    </div>
</body>
</html>
